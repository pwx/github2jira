Summary,Description,DateCreated,DateModified,Status,Reporter,Assignee,AffectsVersion,FixVersion,Resolution,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody,CommentBody
clicking on project in table shifts focus to map,"- from parthiv -

- Whenever a project link is clicked on the bottom of the page, you automatically go back to the top of the page.

- When you click a project title at the bottom of the page, the speech bubble that appears on the map is of the default size and any extra text continues off the speech bubble.

- The filters at the bottom of the page should have a default name instead of being blank, such as Sort by Date for the date column. (repeat the names and also repeat the count of results at the top in addition to the bottom (separate ticket i believe))

 
",10/10/2011 10:14:13,10/10/2011 11:04:45,Open,rajesh,ajaya,Wish List,Wish List,Unresolved,"10/10/11 11:04:41; rajesh; **Author: abhishek**

point #1 & #2 done in commit 3082","10/10/11 11:04:43; rajesh; **Author: abhishek**
point #3 : Changing the controls and repeating them on top and bottom is not possible at this time as per the documentation","10/10/11 11:04:45; rajesh; **Author: rajesh**
there are a couple of ways to fix:

- freeze the column heading so scrolling down still shows them

- move the filters to the top

etc."
reduce spacing on lists on 'floating' menus on RHS column in search/help,"on help pages and search results pages the right column has the menu in floating mode.

however, the spacing is large and on so many screens (netbooks, old monitors, and even on VMware laptops) the bottom of the menu cannot be seen or accessed.

so, we need to tighten the spacing.

a bonus would be to also create a nested list behavior (different bullet, etc.)",10/10/2011 10:14:15,10/10/2011 11:04:51,Closed,rajesh,rajesh,Analytix 1.1,Analytix 1.1,Fixed,"10/10/11 11:04:47; rajesh; **Author: rajesh**
have compressed the list by reducing lines 

creatively use titles ","10/10/11 11:04:49; rajesh; **Author: rajesh**
@3144 changed 3144","10/10/11 11:04:51; rajesh; **Author: vinita**
space is reduced and is working fine."
Migrating to Latest Google Map API,"
1.) Try to get the look n feel of the map like latest maps.google.com maps
",10/10/2011 10:14:20,10/10/2011 11:04:55,Closed,rajesh,rajesh,Analytix 1.1,Analytix 1.1,Fixed,"10/10/11 11:04:53; rajesh; **Author: abhishek**
Done in Commit #3115

1.) Migrated only Analytix code to Google Maps v3
2.) Most of the old code to work with Maps is written in ruby using wrapper library. Either the wrapper library (Cartographer) needs to update itself or we should re-build with another liberary or best solution would be to re-write in plain JS api as compared to server side Ruby.

","10/10/11 11:04:55; rajesh; **Author: vinita**
Looks fine"
analytix date filter not working,"on both qa and www, choose date 2009 to 2009 in project analytix, not logged in. the results do not match the dates.

see attached picture from qa, showing the date filter clearly and the fact that there are 126 entries.

",10/10/2011 10:14:25,10/10/2011 11:05:16,Open,rajesh,vamsee,Bug Fix,Bug Fix,Unresolved,"10/10/11 11:04:57; rajesh; **Author: abhishek**
Fixed in Commit : [http://trac.peerwater.org/index.fcgi/changeset/3112/trunk 3112]","10/10/11 11:04:59; rajesh; **Author: vinita**
on both qa and www, choose date 2009 to 2009 in project analytix, not logged in. the results still do not match the dates.

see attached picture from qa & www, there are 127 entries showing up in QA and 143 entries showing in WWW. 

","10/10/11 11:05:01; vamsee; 
I need some clarifications on this ticket:

* We seem to have removed the Start Date column from the search results. So is searching for 'From' and 'To' still relevant when they can only see End Date?

* In the 'Date Filter' section, the first option says 'Projects started this year'. As far as I can see in the code, the 'From' and 'To' carry forward the same logic - it's only looking for *projects started* between From and To dates. 

* So if you want 'From' to mean projects started on or later, and 'To' to mean projects ended on or before, then I'll change the code. 

Please let me know if I'm not clear. ","10/10/11 11:05:03; rajesh; **Author: rajesh**
Which search results? we are talking about AnalytiX and the table is the same (includes Start Date).

The date filter is only for projects starting (current meaning). That did not seem to be working, Vinita needs to clarify.","10/10/11 11:05:05; vamsee; 
Oops sorry, I was looking in Project Analytix (in Dashboard). 

The start date is indeed visible in PWX Analytix. But the code behaves the same way here - it's finding projects only with starting date between the From and To selections. If you look at all the selected ones, the start dates indeed fall between the selected range only.

If you need it to mean something else, let me know. ","10/10/11 11:05:07; rajesh; **Author: rajesh**
i forgot about the mini-analytix on dashboard, sorry.

assigning it to Vinita who can test to see if it is working (all projects started in 2009 showing up or not). otherwise she can close it as fixed.","10/10/11 11:05:09; rajesh; **Author: vinita**
Project analytix - filter project from 2009 to 2009 the results do not match the dates. Filter should show projects only for 2009 right?","10/10/11 11:05:11; vamsee; 
@vinita currently in the screenshot example the filter is showing all the projects *started* in 2009. The end dates are not being taken into consideration. So the end dates can be anything as long as the projects are started in 2009 (this seems to be logical, because the radio button above year selection says ""Projects started this year""). If this not what you're expecting, you should discuss with Rajesh and let me know.","10/10/11 11:05:13; rajesh; **Author: vinita**
Ok if thats the case the results match both in QA and WWW (results show 145 projects started in 2009).
","10/10/11 11:05:16; rajesh; **Author: vinita**
With regard to the testing I did the following:

Changed the end date (09) for this project http://qa.peerwater.org/projects/134-Water-well-for-Makambie-community-funded-by-SisterSunshine and it shows up when I filter projects for 2009.

Changed the start and end date (2009) for http://qa.peerwater.org/projects/162-Village-2-Test-1-Well-repair-and-maintenance-training 
and it shows up when I filter projects for 2009.

Changed the start date to 2008 and end date to 2009 for http://qa.peerwater.org/projects/163-Village-3-test-2-Well-repair-and-maintenance-training does not show up when I filter projects for 2009.

Filtered project from 2008 to 2009 and the above village details show up.

Also in the ticket can you have a list of things that needs to be tested (recollect you sent me an email long back, unable to trace that email) so I could confirm on those steps to avoid any confusion otherwise I just do a random testing. 

Reopenin the ticket for further testing."
Map URL for all projects needing funds,"Create a URL /map/index?<someoption>=true  which can show all projects needing funds, This is going to be used on contribute(Donation) page.
",10/10/2011 10:14:29,10/10/2011 11:05:20,Closed,rajesh,rajesh,Analytix 1.1,Analytix 1.1,Fixed,"10/10/11 11:05:17; rajesh; **Author: abhishek**
Done in Ticket #8807

/map/index?options[proj_needs_funds]=1

It Works!","10/10/11 11:05:20; rajesh; **Author: abhishek**
Commit #3120"
"Project Analytix : Error for ""funded by anonymous""","For the funded by filter set to ""Anonymous"" , resultant set is empty and leaves the gif loader rotating/waiting infinitely.

https://skitch.com/abpa/rdy7s/pwx-continuing-to-lead-innovation-in-maps-to-serve-the-wash-sector
",10/10/2011 10:14:33,10/10/2011 11:05:26,Closed,rajesh,rajesh,Analytix 1.1,Analytix 1.1,Fixed,"10/10/11 11:05:22; rajesh; **Author: abhishek**
Fixed in  commit 3126","10/10/11 11:05:24; rajesh; **Author: rajesh**
this was a problem afflicting many radio button choices too. as i had shown a week ago, choosing funded by BPN was a problem.
visited by and then choosing one of the 3 options was the same.

i should have put in a ticket immediately.

please don't close tickets - that's for me and vinita to verify.","10/10/11 11:05:25; rajesh; **Author: rajesh**
Vinita, please check (or if you have already checked then close) many filter combos (and dropdown options) to see if AnalytiX hangs on www.

i have checked a few and its working."
sort funder list and add new funder (if needed),"need to sort the funder drop down list (it appears in cycles - Add Funder and probably a few other places).

note that there are 2 parts (each should be sorted independently).

need to add a funder 'Self'. this will be for self-funded community projects (e.g. laughing waters).

now i know i can add that, but i want to understand how to treat it specially like ""Anonymous"" and ""Other"" which i believe get some special treatment (sorry, i should know, but i have forgotten and can't figure out)
",10/10/2011 10:14:47,10/10/2011 11:05:35,Open,rajesh,ajaya,Bug Fix,Bug Fix,Unresolved,"10/10/11 11:05:33; rajesh; **Author: abhishek**
Sorting is done in Commit #3137

I am not clear about 'Self' funder feature please explain with example.

","10/10/11 11:05:35; rajesh; **Author: rajesh**
please also sort the funder list on the admin dashboard.

have renamed 'other' to 'self' for now. no need to do anything for that part."
mark which photo from a project shows up on the map bubble,"right now i think the first photo in the list to show on the bubble.

would like the ability to show the best one and increase its size.

see charity water, for example.",10/10/2011 10:14:49,23/01/2012 12:54:32,Open,rajesh,ajaya,Wish List,Wish List,Unresolved,"23/01/12 12:54:31; rajesh; as part of Cisco2 integration, we want to provide another widget or xml string to get project name, primary project photo, some number (total count, funding), etc.

see for example: http://blueplanetnetwork.org/projects/vietnam and we could automate this so that they don't have to copy the photo or text, but can just run it off the pwx site without going to the pwx site.

so ability to choose a photo and then provide a widget/html string 

@madanvk @mkristian @vcolaco "
links on map do not get cleared,"on the new map, you can click on an app icon and then in the bubble 'links to x reviewers' and see the lines. when you click on another app icon, the old lines do not go away.

this way you can click on as many apps and add to the lines. new unintended behavior.

'Clear Links' on both the normal map and maximized does not work. Only the last app icon links are cleared.",10/10/2011 10:14:54,10/10/2011 11:05:41,Open,rajesh,rajesh,Bug Fix,Bug Fix,Unresolved,"10/10/11 11:05:39; rajesh; **Author: rajesh**
also, double-click on the icon is supposed to bring up both the bubble and the links (the text on top of maximized map clearly states that). double click only brings up the bubble.","10/10/11 11:05:41; rajesh; **Author: abhishek**
1.) Clearing of links is fixed
2.) There is some unknown issue with double click. When I attach click and dbl click event handler to marker, double click will end up generating two clicks (This is weird but normal behavior as per browser api). In PWX map, if the click handler has ajax (which fires infowindow) then dblclick is not being fired. As this is not a very important priority, I have transferred double click functionality to right click.
3.) I have changed small note (in bottom of page) asking users to Right-click rather than dblclick
 

"
map of country from search results causes crash,"i searched for *l* on qa and www.

click on the map of country icon and system crashes. production error is in the email.

qa error below:
--------------------
NoMethodError in MapController#results_for_country

undefined method `mappable_point' for nil:NilClass

RAILS_ROOT: /mnt/apps/qa/releases/20110122195713
Application Trace | Framework Trace | Full Trace

/mnt/apps/qa/releases/20110122195713/app/controllers/map_controller.rb:455:in `add_apps'
/mnt/apps/qa/releases/20110122195713/app/controllers/map_controller.rb:453:in `each'
/mnt/apps/qa/releases/20110122195713/app/controllers/map_controller.rb:453:in `add_apps'
/mnt/apps/qa/releases/20110122195713/app/controllers/map_controller.rb:273:in `results_for_country'

/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/base.rb:1331:in `send'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/base.rb:1331:in `perform_action_without_filters'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/filters.rb:617:in `call_filters'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/filters.rb:638:in `run_before_filters'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/filters.rb:206:in `call'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/filters.rb:206:in `around_proc'
/mnt/apps/qa/releases/20110122195713/vendor/rails/activesupport/lib/active_support/callbacks.rb:182:in `call'
/mnt/apps/qa/releases/20110122195713/vendor/rails/activesupport/lib/active_support/callbacks.rb:182:in `evaluate_method'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/filters.rb:184:in `call'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/filters.rb:635:in `run_before_filters'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/filters.rb:615:in `call_filters'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/mnt/apps/qa/releases/20110122195713/vendor/rails/activesupport/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/mnt/apps/qa/releases/20110122195713/vendor/rails/activesupport/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/rescue.rb:160:in `perform_action_without_flash'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/flash.rb:146:in `perform_action'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/base.rb:532:in `send'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/base.rb:532:in `process_without_filters'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/filters.rb:606:in `process'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/base.rb:391:in `process'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/base.rb:386:in `call'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/routing/route_set.rb:437:in `call'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/dispatcher.rb:87:in `dispatch'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/dispatcher.rb:121:in `_call'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/dispatcher.rb:130:in `build_middleware_stack'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/string_coercion.rb:25:in `call'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/string_coercion.rb:25:in `call'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/rack-1.0.1/lib/rack/head.rb:9:in `call'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/rack-1.0.1/lib/rack/methodoverride.rb:24:in `call'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/params_parser.rb:15:in `call'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/session/abstract_store.rb:122:in `call'
/mnt/apps/qa/releases/20110122195713/vendor/rails/activerecord/lib/active_record/query_cache.rb:29:in `call'
/mnt/apps/qa/releases/20110122195713/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/query_cache.rb:34:in `cache'
/mnt/apps/qa/releases/20110122195713/vendor/rails/activerecord/lib/active_record/query_cache.rb:9:in `cache'
/mnt/apps/qa/releases/20110122195713/vendor/rails/activerecord/lib/active_record/query_cache.rb:28:in `call'
/mnt/apps/qa/releases/20110122195713/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/connection_pool.rb:361:in `call'
/mnt/apps/qa/releases/20110122195713/vendor/rails/activesupport/lib/active_support/cache/strategy/local_cache.rb:24:in `call'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/failsafe.rb:26:in `call'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/rack-1.0.1/lib/rack/lock.rb:11:in `call'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/rack-1.0.1/lib/rack/lock.rb:11:in `synchronize'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/rack-1.0.1/lib/rack/lock.rb:11:in `call'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/dispatcher.rb:106:in `call'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/passenger-3.0.0/lib/phusion_passenger/rack/request_handler.rb:96:in `process_request'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/passenger-3.0.0/lib/phusion_passenger/abstract_request_handler.rb:513:in `accept_and_process_next_request'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/passenger-3.0.0/lib/phusion_passenger/abstract_request_handler.rb:274:in `main_loop'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/passenger-3.0.0/lib/phusion_passenger/classic_rails/application_spawner.rb:321:in `start_request_handler'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/passenger-3.0.0/lib/phusion_passenger/classic_rails/application_spawner.rb:275:in `send'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/passenger-3.0.0/lib/phusion_passenger/classic_rails/application_spawner.rb:275:in `handle_spawn_application'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/passenger-3.0.0/lib/phusion_passenger/utils.rb:479:in `safe_fork'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/passenger-3.0.0/lib/phusion_passenger/classic_rails/application_spawner.rb:270:in `handle_spawn_application'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/passenger-3.0.0/lib/phusion_passenger/abstract_server.rb:357:in `__send__'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/passenger-3.0.0/lib/phusion_passenger/abstract_server.rb:357:in `server_main_loop'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/passenger-3.0.0/lib/phusion_passenger/abstract_server.rb:206:in `start_synchronously'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/passenger-3.0.0/lib/phusion_passenger/abstract_server.rb:180:in `start'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/passenger-3.0.0/lib/phusion_passenger/classic_rails/application_spawner.rb:149:in `start'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/passenger-3.0.0/lib/phusion_passenger/spawn_manager.rb:219:in `spawn_rails_application'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/passenger-3.0.0/lib/phusion_passenger/abstract_server_collection.rb:132:in `lookup_or_add'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/passenger-3.0.0/lib/phusion_passenger/spawn_manager.rb:214:in `spawn_rails_application'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/passenger-3.0.0/lib/phusion_passenger/abstract_server_collection.rb:82:in `synchronize'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/passenger-3.0.0/lib/phusion_passenger/abstract_server_collection.rb:79:in `synchronize'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/passenger-3.0.0/lib/phusion_passenger/spawn_manager.rb:213:in `spawn_rails_application'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/passenger-3.0.0/lib/phusion_passenger/spawn_manager.rb:132:in `spawn_application'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/passenger-3.0.0/lib/phusion_passenger/spawn_manager.rb:275:in `handle_spawn_application'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/passenger-3.0.0/lib/phusion_passenger/abstract_server.rb:357:in `__send__'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/passenger-3.0.0/lib/phusion_passenger/abstract_server.rb:357:in `server_main_loop'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/passenger-3.0.0/lib/phusion_passenger/abstract_server.rb:206:in `start_synchronously'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/passenger-3.0.0/helper-scripts/passenger-spawn-server:99

/mnt/apps/qa/releases/20110122195713/app/controllers/map_controller.rb:455:in `add_apps'
/mnt/apps/qa/releases/20110122195713/app/controllers/map_controller.rb:453:in `each'
/mnt/apps/qa/releases/20110122195713/app/controllers/map_controller.rb:453:in `add_apps'
/mnt/apps/qa/releases/20110122195713/app/controllers/map_controller.rb:273:in `results_for_country'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/base.rb:1331:in `send'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/base.rb:1331:in `perform_action_without_filters'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/filters.rb:617:in `call_filters'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/filters.rb:638:in `run_before_filters'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/filters.rb:206:in `call'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/filters.rb:206:in `around_proc'
/mnt/apps/qa/releases/20110122195713/vendor/rails/activesupport/lib/active_support/callbacks.rb:182:in `call'
/mnt/apps/qa/releases/20110122195713/vendor/rails/activesupport/lib/active_support/callbacks.rb:182:in `evaluate_method'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/filters.rb:184:in `call'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/filters.rb:635:in `run_before_filters'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/filters.rb:615:in `call_filters'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/mnt/apps/qa/releases/20110122195713/vendor/rails/activesupport/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/mnt/apps/qa/releases/20110122195713/vendor/rails/activesupport/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/rescue.rb:160:in `perform_action_without_flash'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/flash.rb:146:in `perform_action'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/base.rb:532:in `send'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/base.rb:532:in `process_without_filters'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/filters.rb:606:in `process'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/base.rb:391:in `process'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/base.rb:386:in `call'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/routing/route_set.rb:437:in `call'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/dispatcher.rb:87:in `dispatch'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/dispatcher.rb:121:in `_call'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/dispatcher.rb:130:in `build_middleware_stack'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/string_coercion.rb:25:in `call'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/string_coercion.rb:25:in `call'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/rack-1.0.1/lib/rack/head.rb:9:in `call'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/rack-1.0.1/lib/rack/methodoverride.rb:24:in `call'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/params_parser.rb:15:in `call'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/session/abstract_store.rb:122:in `call'
/mnt/apps/qa/releases/20110122195713/vendor/rails/activerecord/lib/active_record/query_cache.rb:29:in `call'
/mnt/apps/qa/releases/20110122195713/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/query_cache.rb:34:in `cache'
/mnt/apps/qa/releases/20110122195713/vendor/rails/activerecord/lib/active_record/query_cache.rb:9:in `cache'
/mnt/apps/qa/releases/20110122195713/vendor/rails/activerecord/lib/active_record/query_cache.rb:28:in `call'
/mnt/apps/qa/releases/20110122195713/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/connection_pool.rb:361:in `call'
/mnt/apps/qa/releases/20110122195713/app/middleware/flash_session_cookie_middleware.rb:23:in `call'
/mnt/apps/qa/releases/20110122195713/vendor/rails/activesupport/lib/active_support/cache/strategy/local_cache.rb:24:in `call'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/failsafe.rb:26:in `call'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/rack-1.0.1/lib/rack/lock.rb:11:in `call'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/rack-1.0.1/lib/rack/lock.rb:11:in `synchronize'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/rack-1.0.1/lib/rack/lock.rb:11:in `call'
/mnt/apps/qa/releases/20110122195713/vendor/rails/actionpack/lib/action_controller/dispatcher.rb:106:in `call'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/passenger-3.0.0/lib/phusion_passenger/rack/request_handler.rb:96:in `process_request'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/passenger-3.0.0/lib/phusion_passenger/abstract_request_handler.rb:513:in `accept_and_process_next_request'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/passenger-3.0.0/lib/phusion_passenger/abstract_request_handler.rb:274:in `main_loop'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/passenger-3.0.0/lib/phusion_passenger/classic_rails/application_spawner.rb:321:in `start_request_handler'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/passenger-3.0.0/lib/phusion_passenger/classic_rails/application_spawner.rb:275:in `send'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/passenger-3.0.0/lib/phusion_passenger/classic_rails/application_spawner.rb:275:in `handle_spawn_application'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/passenger-3.0.0/lib/phusion_passenger/utils.rb:479:in `safe_fork'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/passenger-3.0.0/lib/phusion_passenger/classic_rails/application_spawner.rb:270:in `handle_spawn_application'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/passenger-3.0.0/lib/phusion_passenger/abstract_server.rb:357:in `__send__'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/passenger-3.0.0/lib/phusion_passenger/abstract_server.rb:357:in `server_main_loop'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/passenger-3.0.0/lib/phusion_passenger/abstract_server.rb:206:in `start_synchronously'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/passenger-3.0.0/lib/phusion_passenger/abstract_server.rb:180:in `start'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/passenger-3.0.0/lib/phusion_passenger/classic_rails/application_spawner.rb:149:in `start'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/passenger-3.0.0/lib/phusion_passenger/spawn_manager.rb:219:in `spawn_rails_application'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/passenger-3.0.0/lib/phusion_passenger/abstract_server_collection.rb:132:in `lookup_or_add'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/passenger-3.0.0/lib/phusion_passenger/spawn_manager.rb:214:in `spawn_rails_application'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/passenger-3.0.0/lib/phusion_passenger/abstract_server_collection.rb:82:in `synchronize'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/passenger-3.0.0/lib/phusion_passenger/abstract_server_collection.rb:79:in `synchronize'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/passenger-3.0.0/lib/phusion_passenger/spawn_manager.rb:213:in `spawn_rails_application'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/passenger-3.0.0/lib/phusion_passenger/spawn_manager.rb:132:in `spawn_application'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/passenger-3.0.0/lib/phusion_passenger/spawn_manager.rb:275:in `handle_spawn_application'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/passenger-3.0.0/lib/phusion_passenger/abstract_server.rb:357:in `__send__'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/passenger-3.0.0/lib/phusion_passenger/abstract_server.rb:357:in `server_main_loop'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/passenger-3.0.0/lib/phusion_passenger/abstract_server.rb:206:in `start_synchronously'
/opt/ruby-enterprise-1.8.7-2010.02/lib/ruby/gems/1.8/gems/passenger-3.0.0/helper-scripts/passenger-spawn-server:99

Request

Parameters:

{""x""=>""16"",
 ""y""=>""8"",
 ""query""=>{""keywords""=>""*l*""}}

Show session dump

--- 

Response

Headers:

{""Content-Type""=>""text/html; charset=utf-8"",
 ""Cache-Control""=>""no-cache""}",10/10/2011 10:14:57,10/10/2011 11:05:47,Closed,rajesh,rajesh,Bug Fix,Bug Fix,Fixed,"10/10/11 11:05:44; rajesh; **Author: rajesh**
still get an error. on qa, the thing does not crash. but on local (refreshed, svn update, ...) and refreshed with data from www (see both screen and console errors):

'''on the screen''': RuntimeError in MapController#results_for_country

Called id for nil, which would mistakenly be 4 -- if you really wanted the id of nil, use object_id

RAILS_ROOT: /Users/shah/dev/src/pwx Application Trace | Framework Trace | Full Trace

/Users/shah/dev/src/pwx/app/controllers/map_controller.rb:279:in `results_for_country' /Users/shah/dev/src/pwx/app/controllers/map_controller.rb:279:in `each' /Users/shah/dev/src/pwx/app/controllers/map_controller.rb:279:in `results_for_country' /Library/Ruby/Gems/1.8/gems/newrelic_rpm-2.12.3/lib/new_relic/agent/instrumentation/controller_instrumentation.rb:253:in `perform_action' /Library/Ruby/Gems/1.8/gems/newrelic_rpm-2.12.3/lib/new_relic/agent/method_tracer.rb:141:in `trace_execution_scoped' /Library/Ruby/Gems/1.8/gems/newrelic_rpm-2.12.3/lib/new_relic/agent/instrumentation/controller_instrumentation.rb:246:in `perform_action'

/Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/base.rb:1331:in `send' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/base.rb:1331:in `perform_action_without_filters' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/filters.rb:617:in `call_filters' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/filters.rb:638:in `run_before_filters' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/filters.rb:206:in `call' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/filters.rb:206:in `around_proc' /Users/shah/dev/src/pwx/vendor/rails/activesupport/lib/active_support/callbacks.rb:182:in `call' /Users/shah/dev/src/pwx/vendor/rails/activesupport/lib/active_support/callbacks.rb:182:in `evaluate_method' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/filters.rb:184:in `call' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/filters.rb:635:in `run_before_filters' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/filters.rb:615:in `call_filters' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue' /Users/shah/dev/src/pwx/vendor/rails/activesupport/lib/active_support/core_ext/benchmark.rb:17:in `ms' /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime' /Users/shah/dev/src/pwx/vendor/rails/activesupport/lib/active_support/core_ext/benchmark.rb:17:in `ms' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/rescue.rb:160:in `perform_action_without_flash' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/flash.rb:146:in `perform_action_without_newrelic_trace' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/base.rb:532:in `send' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/base.rb:532:in `process_without_filters' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/filters.rb:606:in `process' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/base.rb:391:in `process' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/base.rb:386:in `call' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/routing/route_set.rb:437:in `call' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/dispatcher.rb:87:in `dispatch' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/dispatcher.rb:121:in `_call' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/dispatcher.rb:130:in `build_middleware_stack' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/string_coercion.rb:25:in `call' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/string_coercion.rb:25:in `call' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/params_parser.rb:15:in `call' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/session/abstract_store.rb:122:in `call' /Users/shah/dev/src/pwx/vendor/rails/activerecord/lib/active_record/query_cache.rb:29:in `call' /Users/shah/dev/src/pwx/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/query_cache.rb:34:in `cache' /Users/shah/dev/src/pwx/vendor/rails/activerecord/lib/active_record/query_cache.rb:9:in `cache' /Users/shah/dev/src/pwx/vendor/rails/activerecord/lib/active_record/query_cache.rb:28:in `call' /Users/shah/dev/src/pwx/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/connection_pool.rb:361:in `call' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/failsafe.rb:26:in `call' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/dispatcher.rb:114:in `call' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/reloader.rb:34:in `run' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/dispatcher.rb:108:in `call' /Users/shah/dev/src/pwx/vendor/rails/railties/lib/rails/rack/static.rb:31:in `call' /Users/shah/dev/src/pwx/vendor/rails/railties/lib/rails/rack/log_tailer.rb:17:in `call' /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/httpserver.rb:104:in `service' /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/httpserver.rb:65:in `run' /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/server.rb:173:in `start_thread' /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/server.rb:162:in `start' /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/server.rb:162:in `start_thread' /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/server.rb:95:in `start' /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/server.rb:92:in `each' /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/server.rb:92:in `start' /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/server.rb:23:in `start' /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/server.rb:82:in `start' /Users/shah/dev/src/pwx/vendor/rails/railties/lib/commands/server.rb:111 /Library/Ruby/Site/1.8/rubygems/custom_require.rb:31:in `gem_original_require' /Library/Ruby/Site/1.8/rubygems/custom_require.rb:31:in `require' script/server:3

/Users/shah/dev/src/pwx/app/controllers/map_controller.rb:279:in `results_for_country' /Users/shah/dev/src/pwx/app/controllers/map_controller.rb:279:in `each' /Users/shah/dev/src/pwx/app/controllers/map_controller.rb:279:in `results_for_country' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/base.rb:1331:in `send' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/base.rb:1331:in `perform_action_without_filters' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/filters.rb:617:in `call_filters' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/filters.rb:638:in `run_before_filters' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/filters.rb:206:in `call' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/filters.rb:206:in `around_proc' /Users/shah/dev/src/pwx/vendor/rails/activesupport/lib/active_support/callbacks.rb:182:in `call' /Users/shah/dev/src/pwx/vendor/rails/activesupport/lib/active_support/callbacks.rb:182:in `evaluate_method' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/filters.rb:184:in `call' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/filters.rb:635:in `run_before_filters' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/filters.rb:615:in `call_filters' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue' /Users/shah/dev/src/pwx/vendor/rails/activesupport/lib/active_support/core_ext/benchmark.rb:17:in `ms' /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime' /Users/shah/dev/src/pwx/vendor/rails/activesupport/lib/active_support/core_ext/benchmark.rb:17:in `ms' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/rescue.rb:160:in `perform_action_without_flash' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/flash.rb:146:in `perform_action_without_newrelic_trace' /Library/Ruby/Gems/1.8/gems/newrelic_rpm-2.12.3/lib/new_relic/agent/instrumentation/controller_instrumentation.rb:253:in `perform_action' /Library/Ruby/Gems/1.8/gems/newrelic_rpm-2.12.3/lib/new_relic/agent/method_tracer.rb:141:in `trace_execution_scoped' /Library/Ruby/Gems/1.8/gems/newrelic_rpm-2.12.3/lib/new_relic/agent/instrumentation/controller_instrumentation.rb:246:in `perform_action' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/base.rb:532:in `send' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/base.rb:532:in `process_without_filters' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/filters.rb:606:in `process' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/base.rb:391:in `process' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/base.rb:386:in `call' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/routing/route_set.rb:437:in `call' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/dispatcher.rb:87:in `dispatch' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/dispatcher.rb:121:in `_call' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/dispatcher.rb:130:in `build_middleware_stack' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/string_coercion.rb:25:in `call' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/string_coercion.rb:25:in `call' /Library/Ruby/Gems/1.8/gems/rack-1.0.1/lib/rack/head.rb:9:in `call' /Library/Ruby/Gems/1.8/gems/rack-1.0.1/lib/rack/methodoverride.rb:24:in `call' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/params_parser.rb:15:in `call' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/session/abstract_store.rb:122:in `call' /Users/shah/dev/src/pwx/vendor/rails/activerecord/lib/active_record/query_cache.rb:29:in `call' /Users/shah/dev/src/pwx/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/query_cache.rb:34:in `cache' /Users/shah/dev/src/pwx/vendor/rails/activerecord/lib/active_record/query_cache.rb:9:in `cache' /Users/shah/dev/src/pwx/vendor/rails/activerecord/lib/active_record/query_cache.rb:28:in `call' /Users/shah/dev/src/pwx/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/connection_pool.rb:361:in `call' /Users/shah/dev/src/pwx/app/middleware/flash_session_cookie_middleware.rb:23:in `call' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/failsafe.rb:26:in `call' /Library/Ruby/Gems/1.8/gems/rack-1.0.1/lib/rack/lock.rb:11:in `call' /Library/Ruby/Gems/1.8/gems/rack-1.0.1/lib/rack/lock.rb:11:in `synchronize' /Library/Ruby/Gems/1.8/gems/rack-1.0.1/lib/rack/lock.rb:11:in `call' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/dispatcher.rb:114:in `call' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/reloader.rb:34:in `run' /Users/shah/dev/src/pwx/vendor/rails/actionpack/lib/action_controller/dispatcher.rb:108:in `call' /Users/shah/dev/src/pwx/vendor/rails/railties/lib/rails/rack/static.rb:31:in `call' /Library/Ruby/Gems/1.8/gems/rack-1.0.1/lib/rack/urlmap.rb:46:in `call' /Library/Ruby/Gems/1.8/gems/rack-1.0.1/lib/rack/urlmap.rb:40:in `each' /Library/Ruby/Gems/1.8/gems/rack-1.0.1/lib/rack/urlmap.rb:40:in `call' /Users/shah/dev/src/pwx/vendor/rails/railties/lib/rails/rack/log_tailer.rb:17:in `call' /Library/Ruby/Gems/1.8/gems/rack-1.0.1/lib/rack/content_length.rb:13:in `call' /Library/Ruby/Gems/1.8/gems/rack-1.0.1/lib/rack/handler/webrick.rb:50:in `service' /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/httpserver.rb:104:in `service' /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/httpserver.rb:65:in `run' /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/server.rb:173:in `start_thread' /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/server.rb:162:in `start' /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/server.rb:162:in `start_thread' /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/server.rb:95:in `start' /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/server.rb:92:in `each' /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/server.rb:92:in `start' /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/server.rb:23:in `start' /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/server.rb:82:in `start' /Library/Ruby/Gems/1.8/gems/rack-1.0.1/lib/rack/handler/webrick.rb:14:in `run' /Users/shah/dev/src/pwx/vendor/rails/railties/lib/commands/server.rb:111 /Library/Ruby/Site/1.8/rubygems/custom_require.rb:31:in `gem_original_require' /Library/Ruby/Site/1.8/rubygems/custom_require.rb:31:in `require' script/server:3

Request

Parameters:

{""x""=>""19"",

  ""y""=>""8"", ""query""=>{""keywords""=>""*l*""}}

Show session dump

---

Response

Headers:

{""Content-Type""=>""text/html; charset=utf-8"",

  ""Cache-Control""=>""no-cache""}

'''on console:'''

RuntimeError (Called id for nil, which would mistakenly be 4 -- if you really wanted the id of nil, use object_id):

  app/controllers/map_controller.rb:279:in  `results_for_country' app/controllers/map_controller.rb:279:in  `each' app/controllers/map_controller.rb:279:in  `results_for_country' /Library/Ruby/Gems/1.8/gems/newrelic_rpm-2.12.3/lib/new_relic/agent/instrumentation/controller_instrumentation.rb:253:in  `perform_action' /Library/Ruby/Gems/1.8/gems/newrelic_rpm-2.12.3/lib/new_relic/agent/method_tracer.rb:141:in  `trace_execution_scoped' /Library/Ruby/Gems/1.8/gems/newrelic_rpm-2.12.3/lib/new_relic/agent/instrumentation/controller_instrumentation.rb:246:in  `perform_action' app/middleware/flash_session_cookie_middleware.rb:23:in  `call' /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/httpserver.rb:104:in  `service' /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/httpserver.rb:65:in  `run' /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/server.rb:173:in  `start_thread' /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/server.rb:162:in  `start' /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/server.rb:162:in  `start_thread' /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/server.rb:95:in  `start' /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/server.rb:92:in  `each' /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/server.rb:92:in  `start' /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/server.rb:23:in  `start' /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/server.rb:82:in  `start'

Rendered rescues/_trace (40.2ms) Rendered rescues/_request_and_response (34.3ms) Rendering rescues/layout (internal_server_error)","10/10/11 11:05:47; rajesh; **Author: abhishek**
I checked it just now, It works : https://skitch.com/abpa/rxb7e/search-for-i
"
2 scroll bars are seen when an app. is looked up in the map in IE,None,10/10/2011 10:15:03,10/10/2011 10:15:03,Open,rajesh,vamsee,Bug Fix,Bug Fix,Unresolved
map of country from search results not working well,"when you search for 'india' and click on 'map of country' it seems okay.

if you search for 'kenya' then the map shows office of The Samburu Project in US (it has two office locations, one in Kenya and one in US). The map should only show the Kenya office.

if you search for 'mali' you get the 3 projects in Mali that is the correct.

however, if you search for '*l*' and Mali is one of the results, then the map of Mali shows all the results of the search, not just the Mali ones.

i think the problem is when more than one country ends up the search results, then instead of getting results per country, its all of them.",10/10/2011 10:15:05,10/10/2011 10:15:05,Open,rajesh,vamsee,Bug Fix,Bug Fix,Unresolved
new text for approving applications that are not peer reviewed,"today, we approved an app that was not peer reviewed.

the email was the standard (below) so we need a new text.

[[BR]] -------- Original Message --------

|| Subject: || PWX:  Your application for M&E (Impact Assessment) of MSSCT funded  projects & tech development has been approved for funding! ||
|| Date: || Mon, 7 Feb 2011 !05:50:36 -0800 ||
|| From: || Peer Water Exchange <system@peerwater.org> ||
|| Reply-To: || system@peerwater.org ||
|| To: || rshah@blueplanetrun.org ||

[[BR]] [[BR]] Dear Rajesh Shah,Your application has been reviewed by your PWX peers and has been approved for funding - Congratulations!",10/10/2011 10:15:07,10/10/2011 10:15:08,Open,rajesh,ajaya,Wish List,Wish List,Unresolved
peer and visitor reports should not be editable by project owner,"peer reports and visitor reports are editable today by the project owner.

disallow that.

as part of SMS feature, we will put a report problem to admin button that will tell whether the report needs to be moved to another project.",10/10/2011 10:15:10,10/10/2011 11:05:49,Open,rajesh,vamsee,Bug Fix,Bug Fix,Unresolved,"10/10/11 11:05:49; rajesh; **Author: rajesh**
see if there is linkage between this and !#8714"
new icons on the map,"need to put two of the icons created by Mark on our map.

partial success, and failed.

there is a meeting on tue 15 in california.",10/10/2011 10:15:12,10/10/2011 11:05:53,Closed,rajesh,rajesh,SMS,SMS,Fixed,"10/10/11 11:05:51; rajesh; **Author: abhishek**
Commited in #3189

Looks like this : https://skitch.com/abpa/rqhye/map-icons","10/10/11 11:05:53; ajaya; 
I looked at the code.  Looks good."
Rick McGowan proposed enhancements to application,No description given,10/10/2011 10:15:16,10/10/2011 10:15:16,Open,rajesh,ajaya,Wish List,Wish List,Unresolved
create user hierarchy (within pwx and within org) for features,No description given,10/10/2011 10:15:18,10/10/2011 11:05:59,Closed,rajesh,ajaya,SMS,SMS,Fixed,"10/10/11 11:05:55; rajesh; **Author: rajesh**
longer term, we likely will need the following hierarchy:

0. pwx admin

1. pwx team member

2. funder primary (can do ''some'' cycle stuff and funding assignment)

3. funder team member (can do ''some'' kpi and contract stuff)

4. implementer primary

5. implementer team member","10/10/11 11:05:57; ajaya; 
Accepting the ticket.  We got a long term things to think about.  This might be a good time to look at devise also for the user side of things..

Will keep u guys posted.","10/10/11 11:05:59; rajesh; **Author: rajesh**
combining with !#8714"
Write Wiki entry for server config...,"Document whats on the server and delete the redundant files..
",10/10/2011 10:15:22,10/04/2012 04:01:45,Open,rajesh,vamsee,Ruby 1.9.3 Rails 3.2,Ruby 1.9.3 Rails 3.2,Unresolved,"10/10/11 11:06:01; vamsee; 
Can I assign this to Ajaya?",04/02/12 17:06:01; rajesh; this is now with R3 and solr
multiple owners of projects & funds,"we have CSPC ready to join.

here is the situation:

they get funds from SRTT plus Ambuja Cement Foundation, etc. they pass this funding on to about 20 implementers.

how can we structure the following relationship:

- Funder - SRTT

- Nodal agency - CSPC

- Implementer - e.g SAVA

We want to track SRTT funding but CSPC has to be in the middle somehow. We have this ""implemented by"" field at the end of the project. Can we use it to allow sharing of the project data and also analytix?

This is new and semi-urgent, CSPC called me today (mar 17) and wants in and to bring in all their implementers and upload their projects.",10/10/2011 10:15:24,10/04/2012 04:08:35,Open,rajesh,ajaya,Wish List,Wish List,Unresolved,"10/10/11 11:06:03; ajaya; 
Ok.","10/10/11 11:06:06; rajesh; **Author: rajesh**
one more important conversation happened today with Bunker Roy of Barefoot and Global Rainwater Harvesting Collective (www.rainwaterharvesting.org). they have 1300 projects in 7 countries, through a range of implementers and a bunch of funders.

i can propose a way of us hosting all their data if we can have the projects be 'owned' by implementer, funder and GRHC for management and analytix.","10/10/11 11:06:07; ajaya; 
We gotta look at this more cleanly.  U online?
","13/01/12 12:07:17; rajesh; adding @vamsee and @mkristian 

this may become important as per the conversation with SRTT i had on wednesday.
lets see when they come back. otherwise this and nodal gets pushed out to a future branch"
PWX intenationalization: multi-lingual - Spanish,"looks like we have a summer intern joining PWX from mid-May to mid-August. she is a Fulbright scholar from Bolivia and here is what i proposed to her:

  Interested in an exciting       and intense task that can dramatically change the impact of our       efforts against the water crisis? 

Want to work with organizations working on the ground in all parts       of the world, mostly in remote areas?
 
Want to do marketing and technology? And networking? Fluent in Spanish?
 
Then we have a task for you:
* help convert PWX into a bilingual exchange
* work with an existing Spanish partners to get them to use PWX       for managing water and sanitation projects and also for internal       and external communications
* create a       communications program for the bilingual feature in both English       and Spanish
* do market research to build list of Spanish speaking       organizations in Latin America
* attract more Spanish-speaking organizations (esp. funders) into       the exchange[

You will work on an innovative platform and collaborative process       with a small globally spread team that operates with a new       mindset. Depending on your availability and your pickup of the       sector, you will make progress on as many fronts as possible and       hopefully see the project through to the launch.

----
so clearly, we need to be sure that we can get personalization/preferences for language and some set of pages (project pages to start with) up in time for her.

this is clearly a major differentiator in the water sector and would ensure our continued lead.",10/10/2011 10:15:27,22/03/2012 17:13:51,Open,rajesh,rajesh,Internationalization | Spanish,Internationalization | Spanish,Unresolved,"10/10/11 11:06:09; rajesh; **Author: rajesh**
talked with Rob Bell, ED of El Porvenir. they are in if we implement the Spanish pages. happy to have one of his field offices try it.

will get us their project data.

and of course, wants privacy!","10/10/11 11:06:11; rajesh; **Author: rajesh**
summer intern not happening and maybe this is part of Rails 3 migration","01/03/12 07:56:58; rajesh; no part of R3 migration but could be part of Cisco (increased use)

this requires creating spreadsheets with all the text and labels in English that need to be translated."
download photos in one shot,"for the BPN site, Mark needs to be able to download photos from a project report in one shot.

Compared to deploying our slideshow code and to arranging all the icons on the right nicely, this is lower priority.",10/10/2011 10:15:29,10/10/2011 10:15:29,Open,rajesh,ajaya,Wish List,Wish List,Unresolved
separate implementation progress reports from post-implementation status reports,"feedback from EMW.

lets us divide the Progress/Status reports into 2 sections that clearly delineate reports by implementer filed during project implementation phase and post-implementation.

the dividing line will be the date of the project completion.

once the code is in, rajesh will adjust final labels/text",10/10/2011 10:15:31,10/10/2011 11:06:22,Closed,rajesh,rajesh,SMS,SMS,Fixed,"10/10/11 11:06:13; rajesh; **Author: rajesh**
i think this can go out with the sms stuff. anyone disagree please add notes below asap.

rajesh will put in final label text and also put in help section.","10/10/11 11:06:16; rajesh; **Author: abhishek**
Done in commit # 3295

Please test","10/10/11 11:06:18; rajesh; **Author: abhishek**
There is some issue with version of my query and its incompatibility with server's mysql version



ActiveRecord::StatementInvalid in Projects#show

Showing app/views/projects/_rightcolumn.html.erb where line #127 raised:

Mysql::Error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'and visited_at <= '2011-07-01'))  ORDER BY visited_at DESC' at line 1: SELECT * FROM `proj_reports` WHERE (`proj_reports`.project_id = 322 AND ( and visited_at <= '2011-07-01'))  ORDER BY visited_at DESC","10/10/11 11:06:20; rajesh; **Author: abhishek**
Fixed in Commit #3297","10/10/11 11:06:22; rajesh; **Author: rajesh**
changed labels to fit"
circles of visibility for project reports,"we need to create different levels of visibility for project reports (only the progress/status reports filed by staff):

- private: only within organization

- funder & nodal org (project manager/'owner' when that gets implemented)

- peer group: when we implement project reviews

- public

nice to have defaults for the various types of reports (sms, web, ...)

pwx_admin and the primary contact for the org can change the visibility of each report

this feature is really required for our implementers. have talked to 5 (including Nicaragua) and they want to jump on this",10/10/2011 10:15:36,06/03/2012 08:11:57,Open,rajesh,kristian,Controlled Visibility / Privacy,Controlled Visibility / Privacy,Unresolved,"10/10/11 11:06:24; ajaya; 
See if that attachment makes sense.   I am trying to clarify visibility accross org data ( which we already have now) and project data.

See if the rules makes sense.","12/11/11 05:40:40; kristian; the meaning of private, funder and public is clear

nodal org is not clear at all

peer is vage. to see it as ""peer-private"" could make sense, i.e. only the peer org can see this report

any clearifications welcome","12/11/11 05:51:51; rajesh; adding @ajaya and @vamsee

> peer is vage. to see it as ""peer-private"" could make sense, i.e. only the peer org can see this report any

""peer"" means any member of PWX can see it","12/11/11 05:59:28; rajesh; Nodal org is a new concept that we need to introduce into PWX.
There is no pressure for this to be part of the first release; it can be part of another later version of privacy/permissions.

A nodal agency is an intermediary agency that controls and project manages a certain subset of agencies.
Basically a sub-group. Say a nodal agency is an 'funder' or 'manager' of 10 orgs. Then it can see the data for its 10 orgs. 

What needs to happen:
1. mark an org as a nodal agency
2. designate a org as attached to that nodal agency

Hopefully now, the requirements are clearer enough to get an effort estimate.

The architecture should allow for a 'funder' or 'nodal agency' to be a sub-administrator in the future. I.e. create a funding round and assign peer reviews, etc.
","16/11/11 03:42:26; kristian; just pushed the code to the ""restricted"" branch and just assigned Vinita to the issue hoping to follow procedures.",17/11/11 04:19:40; rajesh; am changing assigning to Vamsee so he can look at the code and comment. Vinita comes into the picture for testing a deployed feature and and thus unlikely for this issue. She will come in the picture to test on the 2 user interface issues created today by me.,"17/11/11 08:30:55; vamsee; Hi @mkristian, I have merged restricted into whackathon and deployed to dev.peerwater.org. Merging into whackathon shouldn't interfere with anything that you've done though, the only conflict I got was on schema.rb, which I resolved and ran the db:migrate. Can you please take a look and see if everything looks ok?","18/11/11 05:46:13; kristian; hi @vamsee,

all specs pass so we are on the good side ;-)",18/11/11 06:15:45; ajaya; Was looking at the permission implementation.  Did we choose to move away from cancan?  Did we do some other look around before rolling our own?,"18/11/11 17:14:30; rajesh; 
    i do not know about
      cancan. you should ask Kristian.
      maybe a conf call is in order?
      thanks for looking into the code.On 18/11/11 11:45 AM, Ajaya Agrawalla wrote:
    
      Was looking at the permission implementation.  Did we choose to move away from cancan?  Did we do some other look around before rolling our own?

--- 
Reply to this email directly or view it on GitHub:
https://github.com/pwx/code/issues/523#issuecomment-2786185","19/11/11 02:32:30; kristian; honestly I do not know anything about cancan either ;-)

so the situation is as such that next week I am working on
ixtlan-guard which I copied and pasted to pwd to the authorization
working. this gem I need to two more projects of mine and one of it
needs the extra functionality which pwx also needs to move from ""copy
and paste"" to gem.

On Fri, Nov 18, 2011 at 10:44 PM, rajesh
<reply@reply.github.com>
wrote:
> i do not know about
>      cancan. you should ask Kristian.
>      maybe a conf call is in order?
>      thanks for looking into the code.On 18/11/11 11:45 AM, Ajaya Agrawalla wrote:
>
>      Was looking at the permission implementation.  Did we choose to move away from cancan?  Did we do some other look around before rolling our own?
>
> ---
> Reply to this email directly or view it on GitHub:
> https://github.com/pwx/code/issues/523#issuecomment-2786185
>
> ---
> Reply to this email directly or view it on GitHub:
> https://github.com/pwx/code/issues/523#issuecomment-2791627
>","21/11/11 07:43:42; rajesh; Hi Kristian,

Out of interest and not knowledge, i looked at both cancan and ixtlan-guard repos on git. Cancan seems popular and supported. You should be the best person to compare the two and pros and cons.
What was your thoughts to develop your own gem? What are your plans for ixtlan-guard? (aside from tech, i would like to know the support plan).

I am in no position to speak technically, but i would see a conf (or online discussion at the minimum) between @ajaya and @vamsee and you (with or without me) to discuss the choices. I trust you are okay with this plan and hope that what you have committed is more architectural and less a specific solution.

The other point to note in this discussion is while the 'nodal' feature is not slated for this release, any implementation should have a easy extension path designed to incorporate it.","21/11/11 08:04:49; vamsee; Hmm. I did hear about cancan mostly as one of the popular plugins for role management in Rails - ""devise for authentication, cancan for authorization"", etc. That said, I can't comment much on the differences or advantages - I haven't used either cancan or ixtlan-guard actively so far. But I can't find cancan-related code in master. I'm guessing this was part of @ajaya's permissions branch? ","21/11/11 08:33:09; kristian; when I look for authorization frameworks a couple of years back I
could not find anything - not sure anymore if I saw cancan and/or if
it supported the datamapper ORM at that time. but then for a restful
application a simple map of controller#action to groups is sufficient
""protection"". recently I spent a quick look at cancan but since most
of my rails project is GWT (javascript) client I found it straight
forward to port the map(controller#action => groups) to javascript
since it is independent of the ORM layer and the communication between
ajax client to rails goes over a restful API. so I have a parallel
authorization on the client as well on the server (the really
important one).

that is why I personally stick to ixtlan-guard. for me devise seems
quite a heavy truck and I am more in line with the ideas of
http://railscasts.com/episodes/250-authentication-from-scratch.

next personal remark: when I see myself into foreign territory like
* unknown datamodel
* unknown overall codebase
* half understanding of the requirements because of the first two points
* unknown cancan framework
* when I tried to merge the permission branch into a local branch then
there were no patches => it was already merged into master but as
Vamsee wrote there was no cancan code

so to ease my life it is obvious to reduce the list by replace cancan
with something where I do have lots of experience from quite some
projects where I use that codebase.

since this week I am going to work on ixtlan-guard and after that I
could replace some of the code from the 'restricted' branch with the
gem (actually everything is prepared for that) or I use another
project to get it integrated with a real world project. in the latter
case I could find some time next week to look into cancan but honestly
I am not really keen on learning cancan.


On Mon, Nov 21, 2011 at 1:34 PM, Vamsee Kanakala
<reply@reply.github.com>
wrote:
> Hmm. I did hear about cancan mostly as one of the popular plugins for role management in Rails - ""devise for authentication, cancan for authorization"", etc. That said, I can't comment much on the differences or advantages - I haven't used either cancan or ixtlan-guard actively so far. But I can't find cancan-related code in master. I'm guessing this was part of @ajaya's permissions branch?
>
> ---
> Reply to this email directly or view it on GitHub:
> https://github.com/pwx/code/issues/523#issuecomment-2812398
>","21/11/11 11:43:20; rajesh; @mkristian, its good thinking from a speed of implementation point of view and from the author's view.

If Ajaya or Vamsee were choosing, it looks like they would choose cancan, so you should convince them on short-term technology advantages and us on the longer term maintenance in addition.

Looking at it from a maintenance point of view and an evolution point of view:
- what is your plan to evolve it further (or not)?
- are you interested in other folks using your gem and supporting them?
- would someone else be able to take over your code (in both PWX and in the gem)?

I would request you to look at cancan from at least the viewpoint of someone creating an alternative solution (which i read you want to do this week). Yours at the very least should show its strength (it could be in simplicity).

Since we are not in a super rush, please could you take a little bit of time to study cancan and even add to the documentation on your gem (where you mention cancan)? I understand you are not interested on learning cancan, but could you please look at it from a using the gem perspective without learning how it works (and i think i am learning about your more as you appear to be keen to want to know more behind the scene stuff more than other folks).

I would like an estimate of effort to put the basic permissions feature in (plus the two user interfaces), in both approaches at a rough level.

Thanks in advance.

@ajaya, can you clarify what code you submitted for cancan and where is it now? ",21/11/11 19:13:53; kristian; I guess I am the wrong person for this,22/11/11 04:28:30; rajesh; A person who knows the issues and has created a gem is arguably the best person for this!
clean up user profile / people stuff,It all looks fine on the user profile page. ,10/10/2011 10:15:39,10/10/2011 11:06:26,Closed,rajesh,rajesh,SMS,SMS,Fixed,"10/10/11 11:06:26; rajesh; **Author: abhishek**
Commit #3253"
allow each site to have status/icons,"currently if a project is visited, all sites in the project are considered visited.

can we create a visited status for each site? this would be reflected in the icons on the map/analytix.

(am creating it in the current milestone to start the discussion in terms of code/testing impact; we can choose the real timing/milestone later)",10/10/2011 10:15:46,10/10/2011 10:15:46,Open,rajesh,ajaya,Wish List,Wish List,Unresolved
structured reports inside project reports,"need to include structured reports in PWX.

these will most be numerical and will involve future enhancements such as graphing and tracking and analytix.

everyone has seen the FLOW demo and so we start by architect the report structure and the engine (limesurvey type rails plugin, anyone?)

Larrie and i have done some brainstorming and i will hand it to him to take it forward.",10/10/2011 10:15:48,06/03/2012 04:37:37,Open,rajesh,rajesh,Structured Reporting,Structured Reporting,Unresolved,"06/03/12 04:37:37; rajesh; adding @thornedev @madanvk @vamsee @ajaya @mkristian 
we can't add attachments, but next week (don't want to distract Vamsee from releasing R3) will send the ppt that Larrie created last year."
Blank SMS should not be saved in MSG central,"Sent a blank msg (@pwxqa) on txtweb received a notification 'Sorry, PWX could not process SMS because: message is blank'. ",10/10/2011 10:15:50,10/10/2011 11:06:29,Closed,rajesh,rajesh,SMS,SMS,Fixed,"10/10/11 11:06:29; rajesh; **Author: abhishek**
Fixed.

Now if you try sending message via phone or txtweb emulator and send just @pwxqa , you should receive ""Message is Blank"" error "
Create a customized system message system,"Too often we build stuff, roll out stuff without anybody knowing how to use.   We need a way to let users know in context what's new and and let them dismiss the message.  Something a cross between https://github.com/jstewart/system_messages and https://github.com/heavysixer/acts_as_dismissible

We need to release this as part of SMS.   We don't get to broadcast and get attention too often.",10/10/2011 10:15:56,13/01/2012 12:04:39,Open,rajesh,vamsee,Wish List,Wish List,Unresolved
Sms messages should generate a notification as soon as the sms  gets convereted to report,"sms messages should generate a notification as soon as the sms
 gets convereted to report",10/10/2011 10:16:00,10/10/2011 11:06:57,Closed,rajesh,rajesh,SMS,SMS,Fixed,"10/10/11 11:06:57; rajesh; **Author: abhishek**
Done.

Commit : #3291"
time of SMS not being stored,"the date is being stored correctly, but the time is 00:00

so multiple messages on a day are shown in the wrong order (not lifo)

see !http://qa.peerwater.org/projects/32",10/10/2011 10:16:04,10/10/2011 11:07:03,Closed,rajesh,rajesh,SMS,SMS,Fixed,"10/10/11 11:06:59; rajesh; **Author: abhishek**
Commit #3298

This change will affect all the report which gets created now onwards, previous data is missing the timestamp","10/10/11 11:07:01; rajesh; **Author: vinita**
tested and works. the last report sent appears on the top of the list.","10/10/11 11:07:03; rajesh; **Author: vinita**
sent sms as member and peer - http://qa.peerwater.org/projects/344-Water-and-Sanitation-in-4-villages-of-Porbandar-Gujarat

"
"Fix Trac Report : Assigned, Active Tickets by Owner","Its supposed to
List assigned tickets, group by ticket owner, sorted by priority.
http://trac.peerwater.org/index.fcgi/report/4


Current Query:
SELECT p.value AS __color__,
   owner AS __group__,
   id AS ticket, summary, component, milestone, t.type AS type, time AS created,
   changetime AS _changetime, description AS _description,
   reporter AS _reporter
  FROM ticket t
  LEFT JOIN enum p ON p.name = t.priority AND p.type = 'priority'
  WHERE status = 'assigned'
  ORDER BY owner, p.value, t.type, time


",10/10/2011 10:16:13,10/10/2011 11:07:08,Closed,rajesh,rajesh,SMS,SMS,Fixed,"10/10/11 11:07:08; rajesh; **Author: abhishek**
Its Fixed.


New Query for reference is:
query:?status=assigned
&
status=new
&
status=reopened
&
groupdesc=1
&
group=owner
&
col=id
&
col=summary
&
col=status
&
col=owner
&
col=type
&
col=priority
&
col=milestone
&
report=4
&
order=priority
"
Requirement for mobile number with correct format,"From Rajesh:
might look like i am creating more work, but actually trying to get more options for future.

can we grey out ""register via sms"" or change the next screen until we have a mobile number?

if we move away from txtweb we would need the mobile numbers of members (to identify incoming) and here is one way to get them.

thoughts?
rajesh",10/10/2011 10:16:19,10/10/2011 11:07:14,Open,rajesh,rajesh,Wish List,Wish List,Unresolved,"10/10/11 11:07:10; rajesh; **Author: abhishek**
Done in Commit #3299

Changes to test
1.) If user has not supplied mobile number previously, clicking on ""register for sms"" will prompt user to update mobile number first
2.) When user edits profile , Mobile number is made mandatory.
3.) The accepted format is : numeric mobile number with '+' in beginning (international format)
4.) Its mandatory even while new profile is being created.  ","10/10/11 11:07:12; rajesh; **Author: rajesh**
move validation of mobile number at time of registration; its been removed from the edit profile code.","10/10/11 11:07:14; rajesh; **Author: vinita**
1.) If user has not supplied mobile number previously, clicking on ""register for sms"" will prompt user to update mobile number first - WORKS

2.) When user edits profile , Mobile number is made mandatory - Yes, WORKS

3.) The accepted format is : numeric mobile number with '+' in beginning (international format)- i typed a mobile number without the '+'.

4.) Its mandatory even while new profile is being created - Works"
Integrate Mobile Version Changes,"Commited in #[http://trac.peerwater.org/index.fcgi/changeset/3301 3301]


Please test the mobile version using a GPRS/3g enabled phone",10/10/2011 10:16:21,22/03/2012 17:23:49,Open,rajesh,rajesh,Wish List,Wish List,Unresolved,"10/10/11 11:07:16; rajesh; **Author: vinita**
Rajesh please test coz i dont have GPRS/ 3G in my phone"
SMS - message central not showing the registered sender's number in the 'From' column??,"Registered my mobile number 9880842261 as the contact no. for Idriss of Saferfuture. Sent an sms and the sender's name and number is registered in message central.
",10/10/2011 10:16:24,10/10/2011 11:07:18,Closed,rajesh,rajesh,SMS,SMS,Fixed,"10/10/11 11:07:18; rajesh; **Author: abhishek**
Fixed in commit #3304"
Profile - add photo error,No description given,10/10/2011 10:16:30,10/10/2011 10:16:30,Open,rajesh,ajaya,Bug Fix,Bug Fix,Unresolved
sort orgs alphabetically in admin review pages,"when selecting for reviews (app and org), the list of orgs should be sorted alphabetically.

the current sort order is by id. 

keep the assigned orgs at the bottom (primary sort, i guess)",10/10/2011 10:16:32,10/10/2011 11:07:34,Closed,rajesh,rajesh,SMS,SMS,Fixed,"10/10/11 11:07:29; rajesh; **Author: rajesh**
login as admin on qa and assign reviews to any org for membership

example: !http://qa.peerwater.org/organizations/145-GreenBlueWhite/reviews/list_reviewers","10/10/11 11:07:32; ajaya; 
changeset:3311","10/10/11 11:07:33; ajaya; 
changeset:3312"
error trying to login as pwxadmin,"don't know how serious or permanent this is, but here is an error on qa trying to login as pwxadmin

http://qa.peerwater.org/home_page/login

= Ferret::!FileNotFoundError        in Home pageController#login =

{{{
File Not Found Error occured at <except.c>:117 in xpop_context
Error occured in fs_store.c:329 - fs_open_input
	tried to open ""/mnt/apps/qa/releases/20110522170720/index/qa_peerwater_org/person/_o3_7.del"" but it doesn't exist: <No such file or directory>


}}}
RAILS_ROOT: /mnt/apps/qa/releases/20110522170720

[http://qa.peerwater.org/home_page/login# Application Trace] |             [http://qa.peerwater.org/home_page/login# Framework Trace] |             [http://qa.peerwater.org/home_page/login# Full Trace]
{{{
/opt/ruby-enterprise-1.8.7-2011.03/lib/ruby/gems/1.8/gems/ferret-0.11.6/lib/ferret/index.rb:285:in `delete'
/opt/ruby-enterprise-1.8.7-2011.03/lib/ruby/gems/1.8/gems/ferret-0.11.6/lib/ferret/index.rb:285:in `<<'
/opt/ruby-enterprise-1.8.7-2011.03/lib/ruby/gems/1.8/gems/ferret-0.11.6/lib/ferret/index.rb:8:in `synchrolock'
/opt/ruby-enterprise-1.8.7-2011.03/lib/ruby/1.8/monitor.rb:242:in `synchronize'
/opt/ruby-enterprise-1.8.7-2011.03/lib/ruby/gems/1.8/gems/ferret-0.11.6/lib/ferret/index.rb:8:in `synchrolock'
/opt/ruby-enterprise-1.8.7-2011.03/lib/ruby/gems/1.8/gems/ferret-0.11.6/lib/ferret/index.rb:267:in `<<'
/mnt/apps/qa/releases/20110522170720/vendor/plugins/acts_as_ferret/lib/local_index.rb:154:in `<<'
/mnt/apps/qa/releases/20110522170720/vendor/plugins/acts_as_ferret/lib/instance_methods.rb:90:in `ferret_update'
/mnt/apps/qa/releases/20110522170720/vendor/rails/activesupport/lib/active_support/callbacks.rb:178:in `send'
/mnt/apps/qa/releases/20110522170720/vendor/rails/activesupport/lib/active_support/callbacks.rb:178:in `evaluate_method'
/mnt/apps/qa/releases/20110522170720/vendor/rails/activesupport/lib/active_support/callbacks.rb:166:in `call'
/mnt/apps/qa/releases/20110522170720/vendor/rails/activesupport/lib/active_support/callbacks.rb:93:in `run'
/mnt/apps/qa/releases/20110522170720/vendor/rails/activesupport/lib/active_support/callbacks.rb:92:in `each'
/mnt/apps/qa/releases/20110522170720/vendor/rails/activesupport/lib/active_support/callbacks.rb:92:in `send'
/mnt/apps/qa/releases/20110522170720/vendor/rails/activesupport/lib/active_support/callbacks.rb:92:in `run'
/mnt/apps/qa/releases/20110522170720/vendor/rails/activesupport/lib/active_support/callbacks.rb:276:in `run_callbacks'
/mnt/apps/qa/releases/20110522170720/vendor/rails/activerecord/lib/active_record/callbacks.rb:344:in `callback'
/mnt/apps/qa/releases/20110522170720/vendor/rails/activerecord/lib/active_record/callbacks.rb:283:in `update'
/mnt/apps/qa/releases/20110522170720/vendor/rails/activerecord/lib/active_record/base.rb:2874:in `create_or_update_without_callbacks'
/mnt/apps/qa/releases/20110522170720/vendor/rails/activerecord/lib/active_record/callbacks.rb:250:in `create_or_update'
/mnt/apps/qa/releases/20110522170720/vendor/rails/activerecord/lib/active_record/base.rb:2538:in `save_without_validation'
/mnt/apps/qa/releases/20110522170720/vendor/rails/activerecord/lib/active_record/validations.rb:1078:in `save_without_dirty'
/mnt/apps/qa/releases/20110522170720/vendor/rails/activerecord/lib/active_record/dirty.rb:79:in `save_without_transactions'
/mnt/apps/qa/releases/20110522170720/vendor/rails/activerecord/lib/active_record/transactions.rb:229:in `send'
/mnt/apps/qa/releases/20110522170720/vendor/rails/activerecord/lib/active_record/transactions.rb:229:in `with_transaction_returning_status'
/mnt/apps/qa/releases/20110522170720/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/database_statements.rb:136:in `transaction'
/mnt/apps/qa/releases/20110522170720/vendor/rails/activerecord/lib/active_record/transactions.rb:182:in `transaction'
/mnt/apps/qa/releases/20110522170720/vendor/rails/activerecord/lib/active_record/transactions.rb:228:in `with_transaction_returning_status'
/mnt/apps/qa/releases/20110522170720/vendor/rails/activerecord/lib/active_record/transactions.rb:196:in `save_without_unsaved_flag'
/mnt/apps/qa/releases/20110522170720/vendor/rails/activerecord/lib/active_record/transactions.rb:208:in `rollback_active_record_state!'
/mnt/apps/qa/releases/20110522170720/vendor/rails/activerecord/lib/active_record/transactions.rb:196:in `save_without_unsaved_flag'
/mnt/apps/qa/releases/20110522170720/vendor/plugins/active_scaffold/lib/extensions/unsaved_record.rb:15:in `save'
/mnt/apps/qa/releases/20110522170720/vendor/rails/activerecord/lib/active_record/base.rb:2622:in `update_attribute'
/mnt/apps/qa/releases/20110522170720/app/controllers/home_page_controller.rb:62:in `login'
}}}

== Request ==
'''Parameters''':

{{{
{""person""=>{""username""=>""pwxadmin"",
 ""password""=>""analytix""},
 ""x""=>""0"",
 ""y""=>""0""}
}}}",10/10/2011 10:16:36,10/10/2011 11:07:38,Closed,rajesh,ajaya,SMS,SMS,Fixed,"10/10/11 11:07:35; rajesh; **Author: rajesh**
repeatable, refreshing page gives error:

Sorry - incorrect username/password combination. 

but after that all seems to be fine.","10/10/11 11:07:38; ajaya; 
Ferret issues.  Ignore for now. I rebuilt the indexes."
New application page - date format not working,None,10/10/2011 10:16:41,10/10/2011 11:07:41,Open,rajesh,rajesh,Bug Fix,Bug Fix,Unresolved,"10/10/11 11:07:40; rajesh; **Author: vinita**
Unable to input date, noticed the error while creating applications for Palmyra. Create new application and click on date you will see the error (pic attached).","10/10/11 11:07:41; rajesh; **Author: rajesh**
date picker is odd on qa.

works fine on local and on www.

date selector looks odd (transparent) but still works.

and you can manually enter date."
can't log out of QA,"on qa, IE8 on XP.

logged in as rajesh and then logout, brings me to successful logout page.

however, home still brings me ""Welcome Blue Planet Network"" on the home page and then dashboard gets me back to dash.

not replicated on FF on OSX. not replicated on local.

repeated 5 times.

finally logged in as bunker and got Welcome Barefoot and can't log out as that.",10/10/2011 10:16:43,10/10/2011 11:07:43,Open,rajesh,rajesh,Bug Fix,Bug Fix,Unresolved,"10/10/11 11:07:43; rajesh; **Author: rajesh**
need to test again ..."
Analytix Graph - software configuration issue,No description given,10/10/2011 10:16:45,10/10/2011 11:07:45,Open,rajesh,vamsee,Bug Fix,Bug Fix,Unresolved,"10/10/11 11:07:45; rajesh; **Author: rajesh**
need to change formatting to 2 decimal"
Map of search results not showing all sites,"http://peerwater.org/kb/search?query[keywords]=samburu&x=0&y=0 shows 30 sites and 31 projects. 'Map it' shows only 9 of them.

even though the text results show 30

Map of org shows all: http://peerwater.org/map/organizations/103-The-Samburu-Project",10/10/2011 10:16:47,10/10/2011 11:07:47,Open,rajesh,ajaya,Bug Fix,Bug Fix,Unresolved,"10/10/11 11:07:47; rajesh; **Author: kristian**
with firefox5 on ubuntu I see all 31 locations on the map - see attachment
"
Update User/People/ Module to have Unique email as account identifier instead of username,"",10/10/2011 10:16:50,02/05/2012 08:08:44,Open,rajesh,ajaya,Wish List,Wish List,Unresolved,"10/10/11 11:07:49; rajesh; **Author: kristian**
deleted user
------------
  give a fancy random username so you can reuse the old one again. email can become something like 'old_username_random@deleted' and still be unique.

one user many organizations
---------------------------
   that is not possible with the current database relation between people and organizations if I see it right.

the password reset
------------------
   that is a public page and anyone can guess usernames like 'rajesh', 'sonia', 'heidi', etc and sent password requests and if I do not like someone and can drive him/her nuts. 

there are at least two ways to avoid this
* use an onetime token to password reset page, you reset the password and be happy. tell the user in the email to ignore the password reset email if they did not ask for it.

* just generate a random password and keep it until the next login. if the login happens with new random password from the email, then that is the password for that user. and can be changed the usual way. if the user logged in with her/his usual password the random password gets discarded. this feels exactly like it is now !!!! again the email can tell the user to ignore it unless you asked for password reset yourself.

with either one approach you just transfer the password reset emails to spam folder in case someone tries some mischief with you unless you really want to reset the password.

storing passwords
-----------------
for storing the password the best practice is to use a seed for encrypting it, i.e. same passwords will produce different entries in the database. that is trivial with bcrypt library which just needs to be used instead of the md5 hash which is used right now. 

the transition to that more secure approach is more tricky but doable without too much trouble if some test driven approach gets implemented.

test driven approach
--------------------
now I reach test driven and why using the example of the password code change. there are several places where there is similar code inside the controller for verifying or creating passwords. this is called 'fat controllers and thin models' which leads to testing similar code for all controllers which use it. and tests need to mock up the controllers in a way that you reach the code which you want to test. that are usually quite ugly testcases/specs and they a fragile since you need to know what the controller is doing - whitebox testing.

the opposite approach to this would be 'thin controllers and fat models', i.e. I put all the password creation, verification, transition from md5 to bcrypt, temporary, etc into the model and have two or three methods on the model: Person.login(username_or_email, password) and @person.reset_random_password and maybe something to set the password. then you come closer to a blackbox testing where do not know what the box is doing but test how it does its job.

with this in place the first version of the model can do the same as now. gets 'tested' and everybody is happy. the second version of the Person does all the improvements and all the different cases can be tested with nice testcases/specs in an automated fashion and then things work ;-) - since all the new code got tested well without a single person doing any clicking on browsers.

:))
"
cannot edit sms message (buttons are hidden),"in message central, when a long SMS comes in and has to be edited, the buttons below the area are not visible so we cannot edit.

this is using FF5 on OSX

2 pictures attached (one with buttons visible and one without)

the spacing has to be increased or css fixed so buttons are always visible.",10/10/2011 10:16:52,10/10/2011 11:07:57,Closed,rajesh,vamsee,SMS,SMS,Fixed,"10/10/11 11:07:51; vamsee; 
Fixed in [d1b28016bc6a0f7968667329bf8397ec5032d287]. Right now I did a quick fix by increasing the height of the container, and it should work in most cases. But we should tweak the design a bit so it will allow flexible box height. Will take a crack at it when there is a similar design issue on the same page again (by then I'll have a better understanding of overall css structure). Until then, this can be pushed if it works in most cases.","10/10/11 11:07:53; rajesh; **Author: rajesh**
Quick fix is fine for this.

Only admin uses this for now - so don't waste time on the flexible box.

When we move msg_central inside orgs ...","10/10/11 11:07:55; rajesh; **Author: rajesh**
please login on qa as admin and see the 160 char sms i sent.

format is still a problem.","10/10/11 11:07:57; vamsee; 
This fix should be on QA by now, please check and close this if it works."
sms hash not being checked properly,"when an SMS comes in, the hash is supposed to be compared to existing hashes in the person's profile.

the comparison always fails (apparently) and so we can never recognize the sender of the message.

for intro to the feature, see the help on SMS reporting.

used to think that the hash from Intuit's txtWeb was changing, but after examining the hashes, i suspect it our code that is doing faulty comparision.",10/10/2011 10:16:56,05/02/2012 05:29:41,Closed,rajesh,vamsee,SMS,SMS,Fixed,"10/10/11 11:08:00; vamsee; 
I have a feeling we're not getting new registration requests from TxtWeb. I tried to register my mobile in both qa and www, no go. Can't be the system's problem, because I'm not seeing a request from TxtWeb in our QA logs. Investigating. Should the mobile number in my profile match the incoming request fully, or how does it work? (I mean, do I need to add +91 to my mobile number entered in the profile?).","10/10/11 11:08:02; vamsee; 
Ok, I take that back. Production is indeed getting requests from TxtWeb, and I was able to register just now. My guess is that it's not working on qa because we have setup basic auth for it, and seems like the usual trick of putting username and password in the url for bypassing the auth prompt didn't work either. My guess is I'll have to disable basic auth for qa for testing this (or at least dev). Is this ok?","10/10/11 11:08:04; rajesh; **Author: rajesh**
Yes, disabling during testing is fine (make sure no robots are allowed).

Also, it would be good to document how to enable/disable/change pwx for web auth.","10/10/11 11:08:07; vamsee; 
We should think about simplifying the mobile registration code. I see in the database that only two people's txtweb mobile code was matched (most likely Vinita & Rajesh, as theirs are the only names being matched). I see in the sent messages that registration codes are sometimes sent without the surrounding the code, single quotes instead of asterisks, etc. 

How about a simpler registration message, say something like: @pwx reg 28383 or something similar? Perhaps even something like: @pwx add 38382 or @pwx add <username> 383883. Not everybody knows how to make those special characters appear (like you have to long-hold in some mobiles to enter *, +, etc). ","10/10/11 11:08:12; vamsee; 
Oops, I meant ""codes are sent without the surrounding asterisks"".","10/10/11 11:08:15; vamsee; 
Most likely this is not the only reason they're not being matched and I'm expecting to see a couple more bugs, but this will definitely help.","10/10/11 11:08:18; vamsee; 
An update - recently I spoke with Rajesh, and he suggested that we should talk to the txtweb developers and arrange a way to get phone numbers instead of a txtweb hash so we can remove the registration step altogether. This sounds like a good idea, but we still might run into problems:

* Not enforcing any validations on the phone number format means that people have entered all sorts of formats, with spaces, dashes, dots, + for country codes, etc. 

* The biggest problem is lack of consistency in people entering these numbers, which means that we cannot check for things like last 10 numbers etc, because people might have entered spaces/dots/dashes in between, which means we might miss some numbers.

* This might be solved partly by removing all spaces, dots, dashes and other possible special chars from the numbers before comparing, but that's still not foolproof, because we might be missing some special chars that we haven't thought of.

* So I think the options for us are, if we want to remove the registration step and get phone numbers from txtweb, we have to either enforce some validations on phone number formats, and/or we remove all the possible special chars from the numbers and then compare. 

* The other option is to stick with txtweb hash checking by asking people to register first and simplify the registration method. Both have their drawbacks, but if we want to skip registration for sure, we'll have to ping txtweb guys and tighten up our comparison checks. 

* The other point I'm checking right now is to why only Vinita & Rajesh have a validated txtweb hash. Writing a few more tests should tell us that soon, will add an update then.","10/10/11 11:08:21; vamsee; 
Been cleaning up the sms code, and I think it's ready for testing. I'll run some live tests @pwxdev myself, and then move it into qa once I'm satisfied. While fixing the code, here's what I observed further:

 * The numbers we have (by way of mobile, day phone, and evening phone) are already 'polluted' with special chars, so there's no going back now (also, users might not appreciate the hassle of entering the format we specify from now on - they'll enter it in the way it's usually done in their country, with relevant special chars.). 

 * So what I'm currently doing is removing all the special chars from each of the people's mobile, day phone and evening phone programmatically and then comparing with the number given by txtweb (which is usually without country code, 10-digit mobile number). So I'm cleaning up all the special chars from mobile/day phone/evening phone and getting the last ten digits (to skip country codes if the user entered them). 

 * But, this is basically moot right now, because txtweb is only giving us a hash. I actually think this is a clever way of saving ourselves the pain of dealing with all the headache with cleaning up numbers. Also, comparing numbers in the current way is resource-intensive because we have to retrieve all 200+ users from the database and do the comparison each time a new SMS comes in because mysql only supports regexp, not regexp_replace (which we need for cleaning up numbers after matching special chars).

 * So I think the easiest path right now is stick with txtweb hash and simplifying the register process with something like: @pwx reg 28383. Then we don't have to deal with funny numbers and international conventions etc. Comparision will be really fast too, because all we have to care about is that special hash given by txtweb. 

 * Moving to numbers and removing the register step is certainly possible, but involve some pain, not to mention some performance hit. If removing the registration step is worth it, then it's definitely doable (assuming that txtweb will give us numbers).

Please let me know if I'm not clear with something. Vinita, if this discussion is too technical for you, I can explain the options on chat if that helps you with testing process.","10/10/11 11:08:24; vamsee; 
The follow-up ticket to this is #8882, which deals with simplifying the sms registration part, so let's continue that discussion there.

As for sms hashes not working, I think I ironed out all the bugs in the process, and deployed the latest to qa. So I think Vinita can start testing on qa by sending the respective messages to @pwxqa and see the results on message center, etc. 

Vinita, I would suggest you start testing from registration etc and do the full cycle, so you can test just the new registration part only when I solve #8882. Also, try to test in the morning - I observed that txtWeb responses get slower in the evening.

I still have one doubt - are the registration messages supposed to show up on message central? ","10/10/11 11:08:26; rajesh; **Author: rajesh**
the automated reg messages did not show up, but now the new ones will show up.

i would suggest that we add more of the fixes in the SMS release before testing.","25/12/11 22:58:57; rajesh; regarding the question of the registration messages showing up in MSG_CTL :
yes, and to provide the functionality of linking of hash to user.

@vcolaco : we will need to do some documentation and call the Indian orgs doing projects now to get all their field staff on PWX, register their SMS and ...

@vamsee what is the status of this code (cleanup part and the new enhancements)? is it correct to assume that the cleanup has been pushed to www via qa? if yes, @vcolaco we need to test hard and fast.","26/12/11 05:00:44; vamsee; Yes, this code is in www now. You can run some tests and see if there are any issues. The only thing that wasn't done was simplifying the reg code, but I believe we post-poned that decision at that time.","05/02/12 05:29:41; rajesh; @vcolaco need to test SMS on www a bit - i think this is fixed. will close this issue and this milestone.

then make sure all of Indian orgs are registered as they have signed the MoU with the last round of funding.

if there is a problem, we can reopen this issue."
move app between cycles and redo peer review,"we have several applications from earlier cycles with status ""Approved, Needs Funding"".

now we see the need to:

1. move them to current cycle - e.g. app id: 309, 310, 312, 313, etc

2. redo peer review: e.g app id: 297

3. edit them - all the above. Admin can edit them, should we allow implementer?

For now, we need #1 and #2 done - provide admin a way to move app thru cycles and also change status to peer review.

Admin can have individual orgs redo their rating, so keep the code simple and keep Q&A and existing ratings.",10/10/2011 10:16:58,10/10/2011 11:08:29,Closed,rajesh,ajaya,SMS,SMS,Fixed,"10/10/11 11:08:29; rajesh; **Author: rajesh**
forgot that AJ had already provided this functionality in 2008!"
Embedding video not working on proposals,None,10/10/2011 10:17:02,04/02/2012 17:04:31,Closed,rajesh,kristian,Cisco | import,Cisco | import,Fixed,"10/10/11 11:08:31; rajesh; **Author: kristian**
if I look around than I see people just putting the youtube link there or only text and that does not work.

anyways a concrete profile or url where things are not working would be great.

further more the whole video tries to sanitize the html but I had no problem to execute any javascript code via that upload. so that sanitizing does not work. plus youtube changed there default embedding code to iframe, dito vimeo is using.

proposal:
* first restrict to youtube.com and vimeo.com
* parse out any url from an iframe or embed tag and store just that url
* if the whole text is just the url from youtube or vimeo just create the embed url for it.
* create the iframe for either vimeo or youtube with some sensible defaults (width, height, etc)

with that we do not store html in the database and the XSS hole is gone.","10/10/11 11:08:33; rajesh; **Author: rajesh**
looks like Kristian has fixed the videos for the app. and rajesh fixed the text.

need to fix all places we have embedded video to links:

- org - profile has video

- project

- project report","06/01/12 13:29:04; rajesh; @vcolaco reported to @vamsee that she had found that many places video links are not working: 

Video link worked only for the project report. FYA below:

· Edited the old app– video does not work. Both short code and the long string embed code does not work. After saving the app & project report the text in the video box shows  ‘unknown video provider’.

· Org profile – video does not show up instead the short video code shows up at the bottom. When I put in the long string embed code its ‘blank’.

· New App – I put in the short code and the long string embed code does not work - ‘unknown video provider’.

· Submitted the project report with the long string embed code – works fine. Can see the video. Short code does not work.

 ",17/01/12 08:15:47; kristian; can I have the short and long codes which did not work ?,"17/01/12 08:54:01; rajesh; while waiting for Vinita to provide the codes, here is an older email from her:

_Rajesh - Are you referring to the video link in Green Empowerment? http://qa.peerwater.org/organizations/132-Green-Empowerment, only this org’s video link is not working. The other orgs Manna, Samburu, Esperanca’s video link is working fine.
 
Also I noticed GP has inserted text instead of the embed code in the box._

Aren't we not supposed to allow text in there?","17/01/12 09:03:58; vinita; @mkristian - for e.g. i was trying to put in a water video from youtube, the short code is 'http://youtu.be/DEnlrE4iMBU' and long link is `<iframe width=""560"" height=""315"" src=""http://www.youtube.com/embed/DEnlrE4iMBU"" frameborder=""0"" allowfullscreen></iframe>`",17/01/12 09:14:30; rajesh; just added a vimeo link on qa: http://qa.peerwater.org/organizations/86-Team-Blue and now the short code shows on the profile at the bottom instead of the video,"18/01/12 16:42:12; kristian; about the Green Empowerment issue there is the text in the video_link is the description and there is no url at all only text. well that text will not work with the new code, but when you eit the text you can copy it to the description part (or delete it).",18/01/12 16:50:12; kristian; since both short as well the long urls are working there is the side effect that the database can stay as is with its 'long urls'.,19/01/12 14:46:04; vinita; short code does not work. Long code works.,20/01/12 04:03:44; kristian; is the new code from develop branch already online ?,20/01/12 05:55:58; vamsee; It's already on qa.,20/01/12 07:30:12; kristian; cool. so more questions. did @vcolaco already used the new code ? if so which short codes do not work and where ? thanx,"20/01/12 11:20:17; vamsee; honestly, I have no clue about this issue. let me talk to her and find out.","20/01/12 15:55:12; vinita; @mkristian - i tested the embed codes in QA and here are the test results:


Org profile video – 
short code does not work instead the code shows up as a text at the bottom of the page. 
Long code works - http://qa.peerwater.org/organizations/6-Safer-Future-Youth-Development-Project
 
Application – Both short code & long code does not work instead text in the box shows up as ‘Unknown video provider’ - http://qa.peerwater.org/apps/136-Well-maintenance-training-for-sustainable-water-su
 
Status report & peer/ visitor reports video – long link works. 
Short code does not work - http://qa.peerwater.org/projects/88-Well-Maintenance-Training-for-Sustainable-Water-Supply-for-Rural-Communities-in-Sierra-Leone-/proj_reports/561 & http://qa.peerwater.org/projects/88-Well-Maintenance-Training-for-Sustainable-Water-Supply-for-Rural-Communities-in-Sierra-Leone-/proj_reports/31
","20/01/12 16:11:35; vamsee; oh wait, @mkristian I think I might be mistaken - did you mean *your* latest code from develop? I haven't merged your changes from develop to staging, if that's what you're asking. Is this all because of my mistake? In that case I'm very sorry - let me know, I'll merge to staging and deploy.","20/01/12 16:38:16; kristian; yes, I was asking about the develop branch ;-)

On Fri, Jan 20, 2012 at 9:41 PM, Vamsee Kanakala
<reply@reply.github.com>
wrote:
> oh wait, @mkristian I think I might be mistaken - did you mean *your* latest code from develop? I haven't merged your changes from develop to staging, if that's what you're asking. Is this all because of my mistake? In that case I'm very sorry - let me know, I'll merge to staging and deploy.
>
> ---
> Reply to this email directly or view it on GitHub:
> https://github.com/pwx/code/issues/546#issuecomment-3585859","21/01/12 06:13:23; vamsee; Okay, I just merged the code from develop into staging, and deployed to qa. Also ran the db migration. Please check if everything is alright.","23/01/12 02:49:11; rajesh; @vcolaco please test on qa for the following video links:
 - youtube.com
 - youtu.be
 - vimeo.com
both long and short (embed) in:
 - org
 - app
 - proj_report

and the known problems in www should be fixed on qa (e.g. African Empowerment is one i verified)
then we are ready to deploy
","23/01/12 07:21:14; vinita; @rajesh - All the links (video displays) are working fine. V
youtu.be links: http://youtu.be/DEnlrE4iMBU  
•	Org profile – works
•	Application – works
•	Status report & visitor/ peer reports - works

youtube link:  <iframe width=""560"" height=""315"" src=""http://www.youtube.com/embed/DEnlrE4iMBU"" frameborder=""0"" allowfullscreen></iframe>
•	Org profile – works
•	Application – works
•	Status report & visitor/ peer reports - works

vimeo link: <iframe src=""http://player.vimeo.com/video/22566556?title=0&amp;byline=0&amp;portrait=0"" width=""400"" height=""225"" frameborder=""0"" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe><p><a href=""http://vimeo.com/22566556"">Water Changes Everything.</a> from <a href=""http://vimeo.com/charitywater"">charity: water</a> on <a href=""http://vimeo.com"">Vimeo</a>.</p>
•	Org profile – works
•	Application – works
•	Status report & visitor/ peer reports - works

",04/02/12 17:04:31; rajesh; seems to work and is deployed to www
map of org not working,"from any org profile, click on 'map of office, applications, and projects' does not work[http://peerwater.org/map/organizations?id=26-Agua-Para-La-Salud-APLS- :]

!http://peerwater.org/map/organizations?id=26-Agua-Para-La-Salud-APLS-

!http://qa.peerwater.org/map/organizations?id=26-Agua-Para-La-Salud-APLS-

!http://dev.peerwater.org/map/organizations?id=26-Agua-Para-La-Salud-APLS-",10/10/2011 10:17:04,10/10/2011 11:08:55,Closed,rajesh,rajesh,SMS,SMS,Fixed,"10/10/11 11:08:38; rajesh; **Author: kristian**
commit 905bc11f432d7bbe228df6d8341e2f2135d4b928
","10/10/11 11:08:46; rajesh; **Author: rajesh**
Vinita please test all the maps: map of search results, regular map, analytix map, etc.","10/10/11 11:08:54; rajesh; **Author: vinita**
Clicked on 'map of office, applications, and projects' for Samburu, Ekoventure, APLS, Saferfuture - the icons show up on the map - works fine.

Search results - map it all - works.

Clicked on map and filtered the data by year for apps, projs, projects needing funding - icons show up on the map. Works.

AnalytiX map - filtered data by projects start date, by funder, by implementer. Details show up on the map. All the links to apps, projs, member office works."
server crash - running out of memory,"last week the server crashed and all pwx sites and bpn were down. could not restart on its own. Ajaya restarted and went thru the logs and discovered we were running out of memory.

Ajaya also researched Amazon options and Rajesh sent a feeler out to VMWare (clearly very distant option).

Ajaya was going to monitor and see how urgent our memory issues are.[[BR]]How soon we need to decide?

Do we want to look at linode or intovps?",10/10/2011 10:17:09,13/01/2012 17:38:57,Open,rajesh,ajaya,Bug Fix,Bug Fix,Unresolved,13/01/12 12:03:18; rajesh; @vamsee and @ajaya are we redoing our server architecture as part of rails 3? or separately?,"13/01/12 13:06:22; vamsee; As of now, separately. As discussed in #586, it's better if we don't bunch up these tasks as they are each quite effort intensive on their own. We'll tackle this once Rails 3 upgrade is stabilized, once there is consensus on what is the best time to do this."
"when SMS gets attached, send SMS to sender","using the hash number, send an SMS back to the sender stating SMS was attached to project id.

i had talked with the Intuit guys and we can send a message back any time (not just immediately)",10/10/2011 10:17:11,05/02/2012 05:27:27,Open,rajesh,vamsee,Wish List,Wish List,Unresolved
document how to set password on qa and remove,"for testing sms features, we need to be able to remove the web password that is current present on qa.

and restore it when done testing.

please document on wiki and train rajesh to do this.",10/10/2011 10:17:13,10/04/2012 03:48:36,Open,rajesh,vamsee,Ruby 1.9.3 Rails 3.2,Ruby 1.9.3 Rails 3.2,Unresolved,"22/03/12 15:29:17; rajesh; can we get this done in this release?
we are testing SMS while @vamsee is in Ruby Conf and on his travels; would be good to be able to lock down and open the website."
functionality to import project data from an org,"we have imported data from WOTR and Gram Vikas through a semi-manual process. we entered in all the cycles and applications manually and AJ wrote a script to import the spreadsheet:

http://trac.peerwater.org/index.fcgi/attachment/ticket/8455/GV_spreadsheet.xls

Vinita and i have imported data for Samburu using a 100% manual process.

We would like to take AJ's script and make it robust. We have data from El Porvenir, Palmyra, APLS, EMW, etc. to import. It can remain semi-automatic - that is cycle and project data are manually created and then projects are imported against that. Or it can be more automated.

Lets start by putting script in the repository with whatever enhancements need to happen. And some documentation on how to use it, etc.",10/10/2011 10:17:15,01/03/2012 07:58:44,Closed,rajesh,vamsee,Cisco | import,Cisco | import,Fixed,"10/10/11 11:08:59; rajesh; **Author: rajesh**
talked with Ajaya, who says there is a script he put in for GV and WOTR imports 2009. 

please work with Vamsee who will find it and then figure out next steps in using it / robustifying it / enhancing it / ...","14/10/11 11:45:43; rajesh; this is from Larrie to make it a real service:

Import:  The reason for having a standardized XML coming into the system is such that we create a ""service"" to receive it.  How that XML gets created is another matter.  Actually, we will need three services:
 1) verify & validate, 
 2) receive for import, 
 3) import (internal service).  

The point of adopting services (SOA) is so that we can reuse the import service when we make the play to be the global water repository.  Always tee up the future when messing with the present.","16/10/11 13:58:10; vamsee; Can't obviously create the XML SOA end point as of now, but I will keep this in mind and try to make the script I'm creating as generalized as possible so we can accept data with as little customization as possible (or at least a simple way to map data columns so the script can read it and create projects accordingly). If it works well enough we can move this to the site so that anybody can import new data by mapping a few columns on the browser and hitting the 'import' button. ","09/11/11 06:59:22; vamsee; What does 'Approximate?' field do? Any idea, @vcolaco?","09/11/11 11:45:36; rajesh; 
    approximate is a flag used
      to inform the reader that the gps coordinates may not be accurate.On 9/11/11 12:29 PM, Vamsee Kanakala wrote:
    
      What does 'Approximate?' field do? Any idea, @vcolaco?

--- 
Reply to this email directly or view it on GitHub:
https://github.com/pwx/code/issues/551#issuecomment-2678163","10/11/11 12:03:44; vamsee; I have created [this wiki page](https://github.com/pwx/code/wiki/Data-import-format) listing all the current columns in the import docs. @satyagrahi kindly go through them and make notes next to each so I can have a better understanding of what's required and what's not. 

What would be very useful is to enforce a numeric constraint on the cost columns so we can take the data directly and save it to the db. We should also mention it should be in dollars because afaik that's what we're using during project creation. I think there is a drop-down mechanism for excel sheets, so we should make people use that for selecting statuses. 

If we can evolve a few rules about which columns take what kind of data and enforce them, automating importing becomes much easier. ","14/11/11 07:49:21; vamsee; Since we're able to remove the step of exporting it to csv, I think we can make the xls file a little more authoritative/detailed to get as much details as possible about the projects from the file itself. So if we are going to import the projects from Palmyra, I'm guessing Palmyra will be an ""Organization"" in our app. If so, will this be created before hand so we can import the project and attach it to an Organization or should I create an org from the details inside the file before importing projects? If it's the latter, can we get this from 'Implementer' column or should we create a row (first?) which asks for 'Organization' in one cell and the providers have to fill in their organization name in the next cell?","14/11/11 11:13:46; rajesh; 
    Not sure about this
      removal of exporting to csv. What do you mean.
      Yes, the project will be imported to an existing org and the data
      will only be for one org.
      Most likely for one year; we will have created the funding cycle
      and the application for all the projects that year.","14/11/11 11:21:55; vamsee; In Ajaya's version of the script, he was using csv files as sources, because I think there were't good excel-handling ruby gems at that time. Recently this gem called 'roo' has added pretty solid support, and I'm using that to read directly from the xls files that @vcolaco gave me, instead of converting the xls files into csv ones first. So that saves one step. 

This also means that we can directly address excel grids, which means we can specify which cell should have which data, i.e gives us more control on the data than csv. 

Okay, so I can assume that the relevant org is already created in the system and I can refer to this org id when I'm creating projects.","14/11/11 16:39:09; rajesh; 
    Yes, you can assume the
      org is created.
      Will we import one worksheet at a time?
      And get to choose which sheet or have to create single worksheet
      files?","15/11/11 07:09:36; vamsee; Oops, missed this one. I forgot to mention, yes, this also means that we can handle excel files with multiple worksheets, and don't need to export each sheet into csv or some such.","15/11/11 07:17:57; rajesh; 
    We import by year, so we
      should be able to specify one worksheet each time.
      Plus there are other worksheets with instructions, codes, etc.","21/11/11 11:28:45; vamsee; Have a couple of basic questions - is the application id (app_id) for a project required? Having an app_id seems to be the only way to connect an org and the project in the current code, so I'm guessing I'll have to create an application also in the script? Does this mean I also have to create a cycle? @ajaya's code for EMW is already assuming an app_id 277 (""EMW - GPOBA Water Projects 2009""). So I'm not sure if I should create a new cycle and an application for each set of projects. 

I can ask for a Cycle name and an Application name while running the import script and create them on the fly, if that makes things easier. ","21/11/11 11:51:45; rajesh; 
    yes, app_id and cycle are required. and auto creation definitely
    makes things easier.
    it would be great if you could create a cycle with today's dates for
    all entries and ask for a cycle name (is there any other field that
    is necessary?).
    it would also be great to create the app, look at the app required
    fields and we can give you defaults for all of them, for example:
    Type: Program Funding (not Project)
    Background: Proposal already approved and funded, this application
    is placeholder for importing existing projects.
    (above comment for all text fields)
    Location should be office location.
    Peer review should be disabled (one important effect is that it does
    not show on the map then)","21/11/11 12:16:32; vamsee; Ok, I'll do this. I'll list more required fields as I work through the script, as I won't be completely sure until I do a full error-free run of importing all data. The other option is including the Cycle name and Application name in the xls sheet (along with the Organization name that I already added), and I will create these if they don't already exist (after taking permission in the script with yes/no answer).

Also, @vcolaco I would like you also to take a look at the [Data Import Format](https://github.com/pwx/code/wiki/Data-import-format) wiki page and let me know what you think. I'm evolving some rules for how the excel sheet should be formatted, etc. You should either make the partners conform to this format, or if it's trivial, you or I could do this ourselves, so the import script will work smoothly. For now, I'm making [this slightly modified palmyra file](https://github.com/pwx/code/blob/importer/import/palmyra1.xls) the reference excel file for the import script. You can take a look and comment if you see anything not plausible. ","21/11/11 12:24:12; rajesh; I would remove the org name from the spreadsheet.
We are going to import by org by year, so we know the org and the year.

We can always add the column after we get data from the org, but the spreadsheet should be something the org has to fill out so lets keep it as simple as possible.","21/11/11 12:25:14; rajesh; Regarding the date of cycle, it would be great to enter it or date-select it.
The earlier more manual import process was:
1. create a cycle with today's date (otherwise we cannot create an app for it)
2. create an app
3. import spreadsheet
4. change the date to date of project year (usually some date at the beginning of the year)

If in the code, if you can create an 'old, expired' cycle and an app against it, then it would save us two steps. So we would like to input a date of our choice - one date for all the date fields.","22/11/11 03:34:18; vamsee; Ok, for Simplicity's sake, I'll do this for now:

1. Revert to @vcolaco's last-sent excel format, with dollar amounts for costs, but without Org name.
2. I will ask for Cycle name, App name and Org name in the script. It will either use existing ones or create new ones after checking for them and asking for cofirmation.
3. Ask before importing each project that if the dates need to be set to a particular year/date. 

Does that match your expectations? We can replace the Cycle/App name as we like when we decide on a default one.

","22/11/11 03:36:43; vamsee; Forgot to add, the script will also ask for all the required params for Cycle/App/Org creation. ","22/11/11 10:55:29; vamsee; Looks like I finally got the opportunity to address #573 along with this. So currently we are only checking for the numericality of fund, which is giving several errors before validation. So I'm going to fix this so that the following fields are required for creation of a new cycle:

1. Name
2. Start Date
3. End Date
4. Fund (also checking numericality)
5. Year (?) -> I'm not sure about this one. Should this also be mandatory?

Can I also assume the Phases' start/end dates don't need to be filled in (by the script)?","22/11/11 13:21:08; rajesh; 
    
      
5. Year (?) -> I'm not sure about this one. Should this also be mandatory?
    
    Please go ahead and make it mandatory. Could be calculated - it
    should be the same as the year of funding.
    Its used on the map - filter by year.","23/11/11 08:03:05; vamsee; Required fields for application that will be requested by the script (will be edited to add more):

1. Name
2. Short Project Description
3. App type (default: program)
4. Start date
5. End date
6. Number of people getting water
7. Number of people getting sanitation
8. Country (drop-down)
10. Background (default: see above - prefill)
11. Approach/Technology (default: see above - prefill)
12. Community Organization (default: see above - prefill)
13. Total Cost (calculated)
14. Cost Details (default: see above - prefill)
15. Funds Applying for

Which of these can we skip (or enter some standard blurb so we don't have to prompt the script user?)",28/11/11 14:37:11; vamsee; What should I enter for the Application name? Should I take this input from the user or can I pre-fill this one too? Can I pick up the first project's name as app name in that case?,"28/11/11 14:52:24; rajesh; 
    this is what we have used in the past:
    WOTR Watershed Development in 49 sites funded by HSBC, Ammada, SDC,
    SRTT, NABARD (2009)
    So, best is to allow input of an app name.
    You can prefill it with ""<org name>: projects for
    <year>"" if you want to be extra helpful.","02/12/11 11:57:08; vamsee; The data for 'Total People Impacted' (required field) in Palmyra is not available, except for one project. Do we guess the rest or will Palmyra give us that data?",02/12/11 12:02:04; vinita; Palmyra will give us the data.,"02/12/11 15:14:40; vamsee; In the application we are going to auto-create, the calculated 'Total Cost' and 'Funds applying for' will be the same, right?","02/12/11 15:53:05; rajesh; 
    yes.
      sometimes we have community contribution numbers, which reduce
      funds applying for.
      eg
http://peerwater.org/apps/273-WOTR-Watershed-Projects-funded-by-GTZ-under-IGWDP-Phase-III-2-6
      we can then manually adjust or do you want the data there somehow.","03/12/11 10:35:34; vamsee; Saving an application requires a person_id (from people table). Can I use pwxadmin's? I see that some of the imported data has @satyagrahi's person_id ('rajesh', id: 20) and in some cases that particular organization's id (there is a username called 'gramvikas', for example).","03/12/11 10:40:47; vamsee; Oh wait, scratch that. Elsewhere in the rake script @ajaya retrieved an Organization's primary contact and set it to person_id required in a project report. Can I do the same? For example, Palmyra has a login named 'Auroville'.","03/12/11 11:14:30; rajesh; 
    yes, the primary contact
      is the right id to set.","04/12/11 05:25:21; vamsee; My guess is the correct status for a project is Approved/Accepted, not Approved/Funded, right? Setting it to Approved/Funded is making the project show up in the applicant's login asking them to accept the funding.","04/12/11 06:02:28; rajesh; 
    you need the right status from the file: complete, in progress. it
    should be beyond approved/accepted.","04/12/11 06:22:08; vamsee; I'm sorry, I meant application status, not project status. I'm am getting the correct status of projects from the file itself.","04/12/11 08:21:17; rajesh; 
    application status will be
      approved/accepted","05/12/11 12:50:37; vamsee; Ok, I have deployed some more changes to demo:

1. Cycle start and end dates. The there is a js validation check if end date is less than start date.

2. Sheets. I thought it's the simplest to just give a box with a default value 1, meaning first sheet of the excel file. If there are multiple sheets, you simply do a second run (since each year's data is supposed to be on 1 sheet, and each year needs one cycle, right?). When doing the second run with second year, choose sheet 2, etc. Let me know if this solution fits the bill. 

3. Cancel button on verify page even if validation passes.

4. I have added links to the respective application and cycle on final results page. Let me know if you want more data to be displayed or more details to be linked to.","05/12/11 13:18:42; rajesh; Please check the validation for cycle dates that is in the normal creation process.
Can you use the same? or part of it?

Basically, if multi-cycle is not on (its been off since the beginning) then a cycle cannot overlap with another. That is a check that is being performed.","05/12/11 13:20:42; rajesh; Sheets: can you extract the name of the sheet?

The current example sheet has the status list (Lists & Info) as the first sheet.","05/12/11 13:34:27; vamsee; I have checked about the multi-cycle thing. For some reason, all the validation is happening in 'Phases' created for a cycle. Since I'm creating Phases only for name sake, I guess this validation is not happening during cycle creation now. I can add this if required on the verify page. 

Yes, I can extract the name of the sheet inside the file. Do you want this to be displayed on the verify page too? Palmyra1.xls and Palmyra1_ef.xls have first sheets set to '2010' for me. Are you sure you didn't select the second page? The script has always been pulling from the first sheet by default, I just gave the option to select others now. ","05/12/11 13:37:28; vinita; I tried to upload the APS data and there were lot of errors.

Vamsee - we added 'total in USD' for the Palmyra sheet and that was not part of the original import sheet. I added that column now, will upload the data and let you know of any errors.

Rajesh - We will need to use the Palmyra sheet as the deafult sheet for import. Will send you the updated sheet. ","05/12/11 13:46:24; rajesh; The only reason to verify a cycle is to make sure that no other cycle overlaps.

The way i do it is:

 - for Indian orgs start/end the cycle on 1/4/xxxx and then the next import for another org for the same year is 2/4/xxxx. 
 - For non-Indian orgs, i start with 1/1/xxxx.

the reason should be obvious, the fiscal year in US starts Jan 1 and in India April 1.

we can make it a process if it is hard to validate. 
first we look at the cycles page and then find the next available date for that year.

:) wish list :) just thought of it :)
the calendar shows up with free dates and used dates are blacked out
:) :) :)","05/12/11 13:49:14; rajesh; @vcolaco - yes, i assume the default sheet will change. 

but will still need to have the 'Lists & Info' sheet somewhere in there - with instructions and data. i prefer that to be the first sheet ""Read Me section"".

each year should be its own sheet and labeled as such. so Palmyra will have several sheets - one for each year of the start of a project.","05/12/11 15:43:01; vinita; @vamsee - 2 things:

1) Import does not recognize worksheet 1, 2 or 3. I had to save the data for APLS as 4 separate sheets year-wise and then i was able to upload the first sheet i.e. 2008 and it worked. Please check APLS data - userid - jackiesuepowell pswd:apls.

2) I got this error thrice when i tried to upload the next year's data i.e. 2009 - system error, pls try refreshing the page or try again later. 

3) I dont see an option for attaching files in GitHub, pls help.","05/12/11 16:09:13; vamsee; @vcolaco, did you try to import the password protected xls files? I'm fairly sure that won't work. Can you disable the password and try? If that didn't work, can you send me those files by mail please? Currently there's no straight-forward way to add a file to a github issue, I'm sorry :(. 

As for the system error, it looks like you're trying to upload 'xlsx' files. The library we use does not recognize those files. You need to convert them into normal xls files, sorry about that too. ","06/12/11 06:05:18; vamsee; I can validate the cycle start and end dates on the verify page. I'll can even try to make this happen by ajax on the first page when the end date has been filled in. But I'm afraid I can't block out the already taken dates in the calendar, as it depends on prototype.js, which has been phased out by Rails in favor of jquery in Rails 3.x. I'm not a fan of Prototype myself, so I'm planning replace it with a jquery-based one when we upgrade. I think the ajax version is going to be more usable anyway.","06/12/11 06:18:54; vinita; Okay I saved the files as .xls and it worked, I uploaded the 2nd sheet and it gave me errors saying 'secondary focus - hygiene education' is not recognized by the system. 

-----Original Message-----
From: Vamsee Kanakala [mailto:reply@reply.github.com] 
Sent: Monday, December 05, 2011 9:39 PM
To: vcolaco
Subject: Re: [code] functionality to import project data from an org (#551)

@vcolaco, did you try to import the password protected xls files? I'm fairly sure that won't work. Can you disable the password and try? If that didn't work, can you send me those files by mail please? Currently there's no straight-forward way to add a file to a github issue, I'm sorry :(. 

As for the system error, it looks like you're trying to upload 'xlsx' files. The library we use does not recognize those files. You need to convert them into normal xls files, sorry about that too.

--- 
Reply to this email directly or view it on GitHub:
https://github.com/pwx/code/issues/551#issuecomment-3018864",06/12/11 06:25:40; vamsee; @vocolaco was the text int he cell 'secondary focus - hygiene education' or just 'hygiene education'? It needs to be latter - exactly the text you mentioned in the Lists & Info page. Then it should recognize.,06/12/11 06:28:25; vamsee; @satyagrahi I've got a doubt - does the start/end dates of the cycle and application need to match? Or can I put the application start date to the oldest of the projects and end date to the latest of the projects under it?,"06/12/11 06:33:06; vinita; Just 'hygiene education'. I just noticed the word is spelt incorrectly, could it be because of that?","06/12/11 06:34:33; vamsee; Yes, spellings definitely matter for checking statuses. Most likely that's the cause. Correct the spelling and try it please.",06/12/11 06:38:24; vinita; @vamsee - the 2nd sheet upload worked.,"06/12/11 10:03:04; vamsee; I have added the cycle date checking on verify page, please test that too. This is a temporary arrangement, I'll add the ajax checking either today or tomorrow.","07/12/11 06:54:47; rajesh; 
    Start and end dates need
      to match, so the cycle is only one day long.
      This way we can create more cycles without overlap. If we do it
      any other way, doing an import for another org will result in
      overlap.
      @satyagrahi I've got a doubt - does the start/end dates of the cycle and application need to match? Or can I put the application start date to the oldest of the projects and end date to the latest of the projects under it?","08/12/11 05:53:49; rajesh; Need to separate funding and total cost.
In the project page, we need 3 numbers: Funding, Community Contribution, and Total Cost.
right now only 2 numbers are being asked in the spreadsheet.

Also, the same 3 numbers need to be put in the Application: Project Cost, Comm Contr, and Funding Requested.
note the order is different.

Summary: change spreadsheet, change project data import, change application data.","16/12/11 05:03:15; vamsee; Regarding the numbers from the spreadsheet: So 'Funding' in Project page and 'Funding Requested' in app are related, right?  I sum up all the 'Funding' numbers from each project and put the total in 'Funding Requested' in the app?","16/12/11 06:42:13; vamsee; I guess since APS data is next, let's fix this funding stuff in that file and I'll make the requisite changes in the script.","16/12/11 09:51:40; rajesh; palmyra sheet no.2 is next!

> Regarding the numbers from the spreadsheet: So 'Funding' in Project page and 'Funding Requested' in app are related, right? I sum up all the 'Funding' numbers from each project and put the total in 'Funding Requested' in the app?

yes","21/12/11 06:48:16; vamsee; I see that 'Reforestation' was added as a status. The database shows 31 statuses, and the excel file (palmyra) shows 20. Should they be synced?","21/12/11 06:59:18; rajesh; Yes, definitely!
I thought i put Reforestation in www as a status? Can't find it.
So, i need to.

How are you planning to sync?","21/12/11 07:14:22; vamsee; Sorry, I meant focus, not status. Yes, I remember you adding Reforestation on www, but I'm not sure what happened. Will dig into it. The ideal place for something like these would be as an array of strings assigned to a constant inside a class, not in the db.","25/12/11 14:37:15; vamsee; Just a heads up - for handling mutliple locations, we need to have a standard notation for the cells that are under project name. I think empty is fine - but if we have to have some text in the cell, I'd prefer something like -do- rather than a couple of double quotes like we have in the current Gram Vikas data file (Dropbox/PWX/docs/import/gv1.xls). Easier to understand for outsiders who are reading the file, I think.","25/12/11 14:50:23; vamsee; Also, I cannot take the no. of people details provided for each location - currently our location object only has lat/long, city, region, country, etc columns. If this location-wise data is really important, I can add columns to proj_locations table to handle this.","25/12/11 22:06:28; rajesh; proj_location people data is for future.
all project data by location, e.g. status, status reports, visitor reports is also for future.","25/12/11 22:09:07; rajesh; re: multiple locations, <empty>, -ditto-, -another-site- 
anything easily documentable, verifiable, editable is fine","26/12/11 06:12:42; vamsee; Looks like the 'Country' column is missing in the gv1.xls file. The columns need to be in the exact number/order as that of Palmyra, or import will choke. Also, can I assume either village or district is mandatory for locations? Since only checking for country and lat/long (currently) is not going be sufficient for extra locations?","26/12/11 06:28:05; vamsee; Correction, there are 4 columns missing in total, but I'll add them for testing for now. ","26/12/11 06:38:50; rajesh; the gv file was only for an example of many sites per project. we are already beyond ... (e.g. country, ...)

- village name has to be there, district / state is optional","27/12/11 05:47:47; vamsee; I just pushed multi-location support to demo. Please test it. I've added a test file called palmyra_import2.xls to Dropbox if you want to test multi-project, multi-location stuff. The village data takes up a lot of space in the verify page (since there are 23 locations), let me know if this is an issue, we'll try to re-arrange the the listing in a different orientation.",27/12/11 05:51:28; vamsee; Forgot to add - this release includes Rails 2.3.14 support from issue no.585 - please keep an eye out for any weirdness and let me know if you see any probs. ,"01/03/12 07:58:44; rajesh; closing this for now, since we have released feature to www.
keeping the full import of all org data till R3 is released on qa and then www"
Spanish phone number not allowed,the mobile validation does not allow numbers from Spain: +34,10/10/2011 10:17:17,10/10/2011 10:17:19,Closed,rajesh,rajesh,SMS,SMS,Fixed
map of org's projects only,"would like to create a map of an org's projects only.

e.g. using a link:

{{{
http://peerwater.org/map/organizations?id=26-Agua-Para-La-Salud-APLS-?show=projects

so only projects, not applications and offices show. this is so that we can send this link around or the orgs can use it in an iframe on their site to showcase their projects.
}}}",10/10/2011 10:17:21,01/03/2012 08:41:52,Open,rajesh,vamsee,Website integration and linking,Website integration and linking,Unresolved,"23/01/12 12:47:26; rajesh; @ajaya @vamsee - this would be good to do for Cisco2 as a way to share data / integrate with other websites

so its another widget

put ""Powered by PWX"" on one corner of the map ","23/01/12 12:57:06; rajesh; from #454 (which is closed being a dup):

provide a map widget so an org can embed it into their website.

for an implementer: all their projects (no apps or locations)

for a funder: all their funded projects (no apps or locations)
"
webinar before next funding cycle,No description given,10/10/2011 10:17:23,10/10/2011 11:09:06,Open,rajesh,rajesh,Wish List,Wish List,Unresolved,"10/10/11 11:09:06; rajesh; **Author: rajesh**
this is suggestion from Kristen of TSP"
"division by 0 on ""projects"" page",http://peerwater.org/projects/ without any parameters will create an error page. just use that url for testing.,10/10/2011 10:17:25,13/01/2012 12:02:01,Open,rajesh,rajesh,Bug Fix,Bug Fix,Unresolved
security hole,"the design is to not be able to see 'Draft' applications.

but if you type in the entire url, you can view any application.

eg. !http://peerwater.org/apps/389

not a problem unless you type in the url with the number.",10/10/2011 10:17:29,10/10/2011 10:17:29,Open,rajesh,rajesh,Bug Fix,Bug Fix,Unresolved
Project AnalytiX filters,No description given,10/10/2011 10:17:32,13/01/2012 12:01:26,Open,rajesh,vamsee,,,Unresolved,"13/01/12 12:01:26; rajesh; i assume this is for some enhancements rather than filters not working ...

or we lost the data from trac in the transfer

am closing this and we can reopen it if something is found on track ( @vcolaco can you please check trac and if you find something put it here or else close it)"
Org AnalytiX - show total amount funded to date for projects for a particular organisation,Show totals in AnaytiX for org,10/10/2011 10:17:34,01/03/2012 08:50:04,Open,rajesh,vamsee,AnalytiX 2.0,AnalytiX 2.0,Unresolved
optimize database queries and load,"solution may help decide whether to move to 3 amazon servers or 2

also may be tied to rails 3 performance improvements",10/10/2011 10:17:36,23/04/2012 03:22:55,Open,rajesh,vamsee,Ruby 1.9.3 Rails 3.2,Ruby 1.9.3 Rails 3.2,Unresolved,"22/03/12 17:23:17; rajesh; is this likely to be fixed in this R3? or will it be in the next one (like to migrate to R3.2).

before moving issue, @ajaya @vamsee need to have a chat and decide what servers do we move to on Amazon","18/04/12 15:50:25; vamsee; I think this is something we can close - I optimize db queries all the time, whenever I get the chance. Maybe open with something more specific, like a page that needs to be speeded up, etc.","23/04/12 03:22:55; ajaya; Agree with Vamsee that we should look at specific pages we have issue and try to fix those by memcache, better db query, eagre loading etc.. 

For the separate DB server, I am out of loop.  Not sure if the load on the current server justify it unless we are trying to build a cleaner infrastructure."
Move the 'Loading' image on to the map in AnalytiX,Overlay the loading image onto the map instead of top left and map moves up after this. Also check out the gap on the right side of the map when there is zoom in/ zoom out.,10/10/2011 10:17:38,10/10/2011 10:17:38,Open,rajesh,vamsee,Bug Fix,Bug Fix,Unresolved
Improve Trac Versions reporting with Git,"Before we changed to git, on the admin dashboard we had under the version info:

- version (more readable than the new long string under git)

- date

- who

It helped me see which was the last release (across www, qa, ...) and which features to test, etc. Can we get some of that info back?",10/10/2011 10:17:40,22/03/2012 15:55:40,Closed,rajesh,vamsee,Rails 3,Rails 3,Fixed,"17/03/12 03:13:07; vamsee; Doesn't belong here, as of now. My idea was to send deploy messages to HipChat, but unfortunately you guys didn't take to it. So I'm gonna setup capistrano to post to google chat when it deploys. If you're not online, usually google chat sends an email about missed chats.","17/03/12 03:51:45; rajesh; i still want to see something on the admin dashboard - messages get deleted and forgotten.

esp. now if our servers are going to be running many different versions - these git strings are hard to compare.",17/03/12 05:03:45; vamsee; Something like this will do? http://awesomescreenshot.com/0931qmwfb (https://deploytracking.heroku.com/)  - click on image for bigger res.,"17/03/12 05:24:15; rajesh; 
    yes - that would be good.
      i don't understand the sentence 'running ... (staging) ... in
      production.
      isn't 'production' a separate instance?
      will we get a picture of all the servers in one go, or separate
      pictures?","17/03/12 06:01:38; vamsee; Yes, we will get a picture of all the servers in one go. My guess is the 'production' part has to be configured in capistrano somewhere... or it picks up from capistrano/multi_stage, which we aren't using yet. 

But we have a way around it for now - since staging branch only goes to QA, it the branch says staging, it means it's deployed to qa. If it says master, it's deployed to www, etc. 

It's a new service, so I'm pretty sure this will be worked on either way.","19/03/12 10:06:20; vamsee; I did a second deploy after we moved the project, here goes: http://awesomescreenshot.com/0b91u1e71. If you look at that, though I feel it could be simpler, you can see that the same git hash is currently deployed from both staging and develop branch. This means that both demo and qa are on the same level now as far as deploying changes are concerned. 

I think it would be even more easier if they let us configure multiple environments, but I guess it can't be far behind. ",22/03/12 15:55:40; rajesh; for now lets go with https://deploytracking.heroku.com/satyagrahi/pwx-1
move source to GitHub,No description given,10/10/2011 10:17:42,17/10/2011 05:28:36,Closed,rajesh,vamsee,Rails 3,Rails 3,Fixed,"10/10/11 11:09:08; ajaya; 
I would advise against this move unless there is something specific feature needed from github.  

Pro:  It's f**king github.  Makes u look cool.

Cons: 
1. Work
2. Need to move all tickets and historical information of checkins to github.
3. Basically need to move trac to github and everything around it.

What you need in github that u don't have now?

","10/10/11 11:09:12; vamsee; 
Yeah, definitely it's going to be a bit of work to move, and most likely a month or two away from happening. But, I think in the long run, it's a good move, and afaik  these are the advantages:

* One less server to worry about administering, afaik Site5 is sending us some warnings about running fsck to check the disk, etc.

* The code review tools at GitHub are awesome. Being able to comment on commits etc are going to be very useful, like Rajesh asked us to comment on his recent commit. This can happen on GitHub, without resorting to email. More context-sensitive too.

* I also got the feeling that we're using Git like SVN, so ideally documentation should be on the wiki or in its own repository, code should be on its own. Git is awesome at branching, so there should ideally be a good UI that supports switching between branches and viewing the code, etc. Basically, Trac is made for SVN. I feel it doesn't do justice for Git's abilities.

* They have recently added Cloud9/Ace editor to the code views, so it's perfect to make quick edits, especially for Rajesh, as he's making a lot of UI-based edits. No need to fire up RubyMine and do the commit/push cycle if they're small edits. 

* Yes, the cool factor is actually a turn off, I agree, but it comes at a great price, so what's the harm, except for the week or so of getting used to the new tool.  And the cool factor is actually backed by a lot of substance :)","10/10/11 11:09:16; rajesh; **Author: kristian**
I am surprised about the cool factor - I guess I missed something :))

but trac personally drives me crazy. for example to write up this, I click on the link on the email, get an error page because I am not logged in, login, 3 times back on the browser and then a reload on the browser.

with github I just reply with an email. so I am pretty sure what I a prefer and the cool factor is of no importance to me, anyways it will be a private repos.

I do also agree with Vamsee that we have the chance during migration to get the actual code in its own repo and the rest (docu and all) in its separate one.

I am sure there is more to say but that my essence","10/10/11 11:09:18; vamsee; 
Perhaps I didn't address the ticket migration properly. There are some scripts that help us in this process (e.g: https://gist.github.com/589126), and I'll spend some time making sure we're migrating all the commit history and the relevant assets/info off trac. Let's say I don't personally have anything against Trac - (I've spent 2 years administering one, I was an early fan actually), but I prefer GitHub now and find it a lot more easy/fun to work with :).

","16/10/11 13:50:32; vamsee; I'm gonna close this, if you see any issues with the github port, kindly open a new ticket.","17/10/11 04:48:30; rajesh; i guess its okay to close, the proof would have been if i could submit (i guess i need to use the word push) some code!","17/10/11 04:49:38; rajesh; 
    as per Kristian's comment,
      i am going to reply via email to see how that feature works.On 16/10/11 7:20 PM, Vamsee Kanakala wrote:
    
      I'm gonna close this, if you see any issues with the github port, kindly open a new ticket.","17/10/11 05:28:36; vamsee; Ah, I understand. I'll help you do that when I visit :)"
backup and recovery - document process and test,"recently, qa was overwritten and some (minor) data lost.

we have a solid backup system in place (www) which should be documented and recovering from it should also be documented and tested.

any backup of qa? maybe a much more reduced, simpler backup system for testing purposes would be good to implement. not required for dev.",10/10/2011 10:17:45,10/04/2012 03:45:04,Open,rajesh,vamsee,Ruby 1.9.3 Rails 3.2,Ruby 1.9.3 Rails 3.2,Unresolved,22/03/12 15:44:57; rajesh; maybe @ajaya and @vamsee can work together to make this happen over the weekend
Lightbox Effect on Galleries,"check out: http://www.samridhdhi.org/gallery

you can click on a thumbnail and get a slide show too.

am sure there are many neat examples.

something to think about in oct, but i did not want to lose this thought.

-r",10/10/2011 10:17:47,10/10/2011 11:09:20,Closed,rajesh,vamsee,Rails 3,Rails 3,Fixed,"10/10/11 11:09:20; rajesh; **Author: rajesh**
dup of !#8563"
Explore moving all static data to S3,"Includes images, videos, etc. And hook it up to CloudFront for faster access, maybe. This means that we don't have to worry about backups, as AWS does dual-zone backup on all S3 assets by default (unless we specify it's not important)",10/10/2011 10:17:51,10/10/2011 11:09:22,Open,rajesh,vamsee,Wish List,Wish List,Unresolved,"10/10/11 11:09:22; vamsee; 
Should have a flag for local view of attachments in case the local instance is unable to connect to AWS due to lack of internet connectivity."
pwxadmin should be able to 'become' a user to do some quick maintenance,None,10/10/2011 10:17:53,13/01/2012 11:57:42,Open,rajesh,vamsee,Wish List,Wish List,Unresolved
Investigate Mysql::Error: Lock wait timeout exceeded; try restarting transaction,"In particular, does this happen only with this project (id 418, ""418-D4W7-Ldupai-Jerusalem-Well"") or with everything else. Error report (repeated nearly 40+ times):

[production-PWX]proj_reports#update (ActiveRecord::StatementInvalid) ""Mysql::Error: Lock wait timeout exceeded; try restarting transaction: UPDATE `projects` SET `updated_at` = '2011-08-30 12:47:51', `modified_at` = '2011-08-30 12:47:51' WHERE `id` = 418""",10/10/2011 10:17:55,13/01/2012 11:57:16,Open,rajesh,vamsee,Bug Fix,Bug Fix,Unresolved
Get rid of DoubleRenderError in proj_list_json,"I've seen this happen quite often too. From my preliminary observation, looks like it happens when the search returns zero results.",10/10/2011 10:17:57,13/01/2012 11:56:36,Open,rajesh,vamsee,Bug Fix,Bug Fix,Unresolved,"13/01/12 11:56:36; rajesh; don't know if such bugs can be fixed in the rails 3 upgrade, but certainly does not belong in this milestone"
Get Vinita started with Janova,Start trying out Janova testing tool so Vinita could start creating the required test cases. Start here: (http://support.janova.us/forums/364440-janova-tutorials-getting-started),10/10/2011 10:17:59,22/03/2012 15:27:13,Open,rajesh,vinita,Structured Reporting,Structured Reporting,Unresolved,10/11/11 08:27:31; rajesh; @vinita - can we create tests so as to not have the IE problem on home page again?,"11/11/11 05:36:16; vamsee; Actually, I was telling @vcolaco the same thing. This would be a good example to start with. (@satyagrahi, you should refer to users with their username when you use the '@' format, so they get notified that you mentioned them).","11/11/11 05:40:00; rajesh; 
    
    i used @vinita instead of @vcolaco.
    if Janova can test IE env and FF, etc. it would be great.","13/01/12 09:59:52; rajesh; @vamsee can we use Janavo for at least sanity testing 3.0 migration?

need @vcolaco to really dig into this.","13/01/12 10:27:34; vamsee; Yes, we can. Whenever @vcolaco is free :)","13/01/12 14:52:35; vinita; @vamsee - can we spend a few hours on tuesday, when i come to WF. ","13/01/12 17:37:39; rajesh; am surprised to not see an invitation by @vcolaco to @vamsee to come over - a nice lunch included?

anyway, do the two of you need to be alone, away from me, for best results?
is there any advantage to my learning janova?
vc is here only for 4 hours so devoting 2 to janavo - means the rest of the stuff needs to happen very quick.","14/01/12 09:56:42; vamsee; To be honest I'm not really kicked about the tuesday date - I'm not really sure I will be done with the Rails 3 first release by that time, and that's priority. Perhaps a few hours after this on Skype? Some time on Thursday/Friday? I think it's better we slowly hobble along on Skype for a few hours every week. Say every friday afternoon? ","14/01/12 10:47:37; rajesh; isn't this something to be done in parallel? without distracting too much from the rails3 release, set up tests so that the release(s) are vanilla tested and more. skype is a good option - but has @vcolaco gone thru all the training videos, etc online?","14/01/12 15:52:09; vinita; @vamsee - you are welcome to my place anytime its just that with Sid and Shania around there will be a lot of distraction. I did go through the training videos, some of it just went over my head. So lets go through it on skype next week, once you are through with rails3. 

","16/01/12 05:40:56; vamsee; This should be done in parallel, but I guess not at this stage - it makes sense once I put up a working version on demo, as Janova needs a url to run the tests against any way. Also, I will fix the most obvious bugs by that time, so we can test more subtle bugs that I missed through Janova. 

@vcolaco, I'll try to catch up on Skype for a small session so you can start testing against the Rails 3 branch as soon as I deploy it to demo.","22/03/12 15:26:47; rajesh; @thornedev is added - i don't think this is likely in the rails 3 release, so will park it, but hope to not lose trac of this"
Simplify sms registration process,"Currently the registration process for mobiles requires putting asterisks around the 5-digit auto-generated number which seems to be complicating the step, as some users don't know how to create the asterisks on their phone. They are entering pluses, dashes, spaces, etc, throwing off our mobile detection algorithm. 

In order to avoid this, we should simplify the mobile registration process by eliminating the asterisks to detect it as a registration message, and use something straightforward like:

@pwx reg 23838

or, even the mobile number of the user, like so:

@pwx reg 9840365177

We can compare this number with the one which we have on the user's profile and register him (and assign the txtweb-mobile hash that comes along with the message for further matching).",10/10/2011 10:18:01,05/02/2012 05:27:06,Open,rajesh,vamsee,Wish List,Wish List,Unresolved,"10/10/11 11:09:24; rajesh; **Author: rajesh**
we should set the text to: @pwx reg 988888888 rajesh or ""@pwx 999999999 rajesh"" basically saying ""SMS @pwx a message that includes your phone number and your name"".

what really needs to happen is that, since the process is manual, admin gets a way to choose a user and click - 'Register'. that button should be there for all messages (regular or registration).

so maybe next to the current buttons, we need a new one 'Register' which is greyed out until a user is chosen and then can be clicked to register a user. if its only a reg message, then admin deletes it, otherwise it can also be edited and assigned to a proj_report.","14/10/11 11:49:57; rajesh; One way to simplify is use the human touch:

Send an SMS with the person's name in it and then admin in MSG CTL can assign the incoming hash to the person's profile for registration.","16/10/11 14:01:17; vamsee; Hmm, interesting. Will definitely create something like this so if the self-registration fails the admin can authorize the user  manually.","17/10/11 04:53:12; rajesh; some checks and balances:

if the hash is already present, PWX highlights the user, but its upto the admin to overwrite.
so, don't allow the admin to assign hash if already present. only if it does not exist in the db."
Admin should be able to send sms to any registered user,"The admin should be able to send sms to any registered user through txtweb response (and/or a 3rd-party sms gateway) to give personalized instructions, etc.",10/10/2011 10:18:03,05/02/2012 05:26:38,Open,rajesh,vamsee,Wish List,Wish List,Unresolved,"25/12/11 22:47:15; rajesh; @vamsee - Can we get a status on this issue: Is it possible with the new TxtWeb changes?
What is the effort estimate?

With the new projects by Project Well and Ekoventure and new funding from Arghyam, can we quickly enable a prototype of this feature to ensure higher frequency in reporting? Either automatically or manually by @vcolaco 

Clearly it is part of the Cisco2 notifications strategy - we need to gather requirements but this prototype could be pushed it thru fast; even as a basis to talk about requirements.

We need to administer this milestone and issues related to it correctly.
","26/12/11 05:07:43; vamsee; I wouldn't get started on a new feature at this point of time - we're already on the way to Rails 3.x transition, so I would keep this off until we reach at least 3.0.x. Urgent bug fixes/quick enhancements to the code base are fine, but starting two new things at the same time is not a good idea. Also consider that there is always some time spent on fine-tuning a prototype implementation, so it's never as quick as it seems. "
photo gallery link on home page broken,"when you click on the photo gallery you get a 404.

also, the options for the slide show include a lightbulb when you hover over and should be removed.

beautify the whole thing! (increasing size is first step)",10/10/2011 10:18:05,16/12/2011 05:44:52,Closed,rajesh,vamsee,Cisco | import,Cisco | import,Fixed,"19/10/11 13:42:50; vamsee; The links are fixed, and removed the lightbulb with ""false"" on hover. Deployed to dev, plz check. Now it shows ""click for details"" without the bulb. @satyagrahi, I don't think we can see the images on localhost unless we have the particular image in our /system folder in our dev machines. I don't, so it doesn't work for me, obviously. If you have the backup of all the images, we can make this work for you on localhost. We need to discuss what you're expecting on the beautification side.","20/10/11 12:26:51; rajesh; interesting that it worked on dev but not on qa.
make sure we really test both on qa and www (when we finally deploy).
it could work better or not on www than qa.",08/11/11 11:23:51; vamsee; This was pushed to production recently. @vcolaco please check this and close the ticket if you're satisfied.,08/11/11 12:51:39; vinita; On www & qa image gallery is blank. Pls fix the error asap. Testing on IE8.,"08/11/11 16:44:20; rajesh; 
    i can see it on FF6 (and
      Safari) on OSX on both qa and www.
      can you please add info on your browser and os, etc. ?
      maybe you need to wait a few more seconds - it appears to be the
      last thing to load.On 8/11/11 6:21 PM, vcolaco wrote:
    
      On www & qa image gallery is blank. Pls fix the error asap.

--- 
Reply to this email directly or view it on GitHub:
https://github.com/pwx/code/issues/572#issuecomment-2667062","09/11/11 06:07:34; vamsee; Thanks @vcolaco, that's weird, I'll also test on IE6/7 and see if it's showing the same behavior and push a fix again soon.","09/11/11 19:17:43; rajesh; 
    i tested on IE8 (lets
      ignore IE6/7) on XP and the photo gallery does not show.
      this is the error:
      Webpage error details
      User Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1;
      Trident/4.0; InfoPath.2)
      Timestamp: Wed, 9 Nov 2011 19:14:16 UTC
      Message: Object doesn't support this property or method
      Line: 4
      Char: 952
      Code: 0
      URI:
      http://peerwater.org/javascripts/secondary_packaged.js?1319617793On 9/11/11 11:37 AM, Vamsee Kanakala wrote:
    
      Thanks @vcolaco, that's weird, I'll also test on IE6/7 and see if it's showing the same behavior and push a fix again soon.

--- 
Reply to this email directly or view it on GitHub:
https://github.com/pwx/code/issues/572#issuecomment-2677856","10/11/11 05:51:27; vamsee; Hmm, that sounds like an IE-specific JS error. I'll look into this. @satyagrahi, I think you should clear the quoted text before replying - shows up kinda weird on github.","10/11/11 08:02:42; vamsee; @vcolaco has tested this on qa and confirmed the fix is working, so I moved it to www. If it works there too, kindly close this ticket.","10/11/11 08:26:34; rajesh; tested on IE8 on XP. works fine, clicking returning to home page and repeating process several times.","10/11/11 09:22:12; vinita; Works fine both on qa and www. Rajesh has closed the ticket.

-----Original Message-----
From: Vamsee Kanakala [mailto:reply@reply.github.com] 
Sent: Thursday, November 10, 2011 1:33 PM
To: vcolaco
Subject: Re: [code] photo gallery link on home page broken (#572)

@vcolaco has tested this on qa and confirmed the fix is working, so I moved it to www. If it works there too, kindly close this ticket.

--- 
Reply to this email directly or view it on GitHub:
https://github.com/pwx/code/issues/572#issuecomment-2692529"
Debug new cycle creation form,New cycle creation fails with all sorts of errors when dates are not given properly. Make sure proper validation notices are shown instead.,10/10/2011 10:18:07,10/10/2011 10:18:07,Open,rajesh,vamsee,Bug Fix,Bug Fix,Unresolved
Replace DRb cache store with Memcache,"The DRb cache store seems to be occasionally acting up and throwing errors, Let's switch to memcache store while doing Rails 3 migration.",19/10/2011 07:29:03,19/03/2012 11:02:51,Closed,vamsee,vamsee,Rails 3,Rails 3,Fixed,27/10/11 05:15:53; kristian; switching to memcache means adding another single point of failure to whole application. I could write more about memcache but is the cache store produces errors then we have a problem with the database itself.,"27/10/11 08:05:01; vamsee; Hmm, usually I don't see memcache being a point of failure, but I won't rule out the possiblity. But I'm not too much in favor of ruby-based caching, as it eats more memory and slower to process requests than native solutions like memcached. I'm open to be convinced otherwise. 

I'm not sure what kind of ruby constructs we are using for caching (will look into it) but I'm guessing it's hashes. There's this problem with using hashes: http://book.ramaze.net/documentation/Innate/Cache/DRb.html.",19/03/12 11:02:51; vamsee; We're using dalli store on qa/www. I think this can be safely closed.
Project report updates notification,"As of now we receive alerts from PWX notifying that there is some reporting activity on a particular project with the project ID but what has been updated/ changed needs to be notified?

For e.g. if the member updates the narrative or the cost details in the project report, the notification should say 'narrantive or cost updated in report'.",21/10/2011 08:48:15,21/10/2011 08:57:59,Open,vinita,vamsee,Wish List,Wish List,Unresolved
Reporting tool to compile reports ,"Create a tool that can collate reports.


",21/10/2011 09:04:29,23/01/2012 12:34:41,Open,vinita,vamsee,Wish List,Wish List,Unresolved,23/01/12 12:34:41; rajesh; @vcolaco please expand/clarify your request
Beautify PWX Blog,"",21/10/2011 09:07:46,21/10/2011 09:09:41,Open,vinita,vamsee,Wish List,Wish List,Unresolved
Incorrect URL for The Samburu Project,"http://peerwater.org/organizations/103-The-Samburu-Project

When you go to the page for the Samburu project and scroll down there is a field for the website:
""Annual Water and Sanitation Budget (in USD) $285,990
Annual Non-Water Budget (in USD) $107,070
Website www.thesambururoject.org""

The URL in the website is missing a ""p"".  It reads ""www.thesambururoject.org"" it should read ""www.thesamburuproject.org""

""roject"" vs. ""project"" 
",31/10/2011 08:04:36,10/11/2011 05:53:16,Closed,madan,,,,Fixed,10/11/11 05:53:16; vamsee; Fixed by @satyagrahi
Analytix Filtering by Year,"http://peerwater.org/analytix

I set the filter to show only projects funded by BPN in 2010, i.e. 2010 to 2010.  But it returned all projects. 

",31/10/2011 11:13:33,01/03/2012 08:55:08,Open,madan,vamsee,AnalytiX 2.0,AnalytiX 2.0,Unresolved
Create a way to generate a datamodel diagram on demand,"Vallari asked for a current data model diagram. Since we're changing it all the time, figure out a way to generate it on the fly.",11/11/2011 07:49:07,16/12/2011 05:44:52,Closed,vamsee,vamsee,Cisco | import,Cisco | import,Fixed,"22/11/11 10:51:49; vamsee; Used dbVisualizer, and sent it to Vallari."
provide admin ability to edit review ratings / comments,"just like admin is allowed to edit qandas, admin should be allowed to edit comments in the ratings section.

this is for both membership and applications.

if editing the rating (radio button) is harder, it could deferred.",16/11/2011 05:10:12,10/04/2012 04:06:32,Open,rajesh,ajaya,Ruby 1.9.3 Rails 3.2,Ruby 1.9.3 Rails 3.2,Unresolved,"16/11/11 05:15:30; kristian; isn't admin something like a superuser or root-user of the system, so it should be able to anything possible on the system ? or are ""admins"" bound to an organization ? I am sure this is related to https://github.com/pwx/code/issues/435","16/11/11 05:21:12; rajesh; yes, login id #1 (pwxadmin) is a super user.

when logged in and visiting a qanda page, you can see an edit button next to each qanda.
however, that edit option is not there on the ratings&comments tab.

yes, related to 435, but right now no org admin and no requirements on what text they should be able to edit
"
report visibility options for user,"The privacy visibility feature is restricted to the reports coming under ""Operating Status Reports"" and ""Implementation Phase Reports"". That is 'proj_reports' by implementer themselves.

Each report should have an admin box:
- currently admin box should be on top of RHS above the current 'Project Summary' 
- it is visible only to implementer admin (primary contact for now) and to pwxadmin
- it should have the following options (radio buttons or drop down or ...):
   + public
   + PWX members
   + private
- a link to a help page for description would be good. i am open to bubble help (that is currently present) or to new forms of presenting explanation.

If the report is not to be visible in the current session, then the following text should be visible in the project report list:

    ""Internal report (private)"" By <user> of <org> on Wed, 16 Nov, 2011

or something similar. The ""Private"" can be a label like ""SMS"" but then we will need ""Private"" ""SMS"" and ""Private SMS"".


adding @vamsee @ajaya @vcolaco",17/11/2011 04:06:46,06/04/2012 03:32:40,Open,rajesh,kristian,Controlled Visibility / Privacy,Controlled Visibility / Privacy,Unresolved,06/04/12 03:32:40; rajesh; right now the private report is completely invisible - please can you make it 'just visible' as mentioned above?
report visibility defaults for org,"The privacy visibility feature is restricted to the reports coming under ""Operating Status Reports"" and ""Implementation Phase Reports"". That is 'proj_reports' by implementer themselves.

Each org profile should have an admin box for privacy defaults for project reports:
- currently admin box should be above ""Projects"" on RHS below 'Documents'
- it is visible only to implementer admin (primary contact for now) and to pwxadmin
- it should have the following 2 options with 3 sub-options (radio buttons or drop down or ...):
 * Defaults for Status Reports:
   + public
   + PWX members
   + private
 * Defaults for SMS Reports:
   + public
   + PWX members
   + private
- a link to a help page for description is needed. i am open to bubble help (that is currently present) or to new forms of presenting explanation.

adding @vamsee @ajaya @vcolaco",17/11/2011 04:15:07,10/04/2012 09:27:56,Open,rajesh,rajesh,Controlled Visibility / Privacy,Controlled Visibility / Privacy,Unresolved,"27/01/12 06:34:48; rajesh; need to decide whether the privacy options are hierarchical or not.

if hierarchy then a drop down works and checkboxes do not.

when nodal concept is introduced it can be between funder and peer, as per my understanding.
so then dropdown works.

so time to add the defaults in the org profile.","27/01/12 07:52:37; rajesh; would be great to see the use of a slider for this feature - no further explanation would be necessary
","27/01/12 12:41:49; rajesh; something like this:
http://www.asp.net/ajaxlibrary/AjaxControlToolkitSampleSite/slider/slider.aspx
or
http://www.avengersutd.com/blog/2010/10/custom-color-chooserpicker-dialog-with-alpha-slider-for-windows-forms-in-c/

with text instead of numbers ","27/01/12 19:28:39; rajesh; This (the 2nd one) is a great find. I like it because it shows the range thru the headings, and text in the tab can be the all the help that is needed. Horizontal is fine.

I assume that there are no issues with R3 and these UI in jQuery.

Thanks,
Rajesh

On 28/1/12 12:49 AM, kristian wrote:
> which is basically a mixture of
>
> http://jqueryui.com/demos/slider/#slider-vertical
> http://jqueryui.com/demos/slider/#tabs
>
> in jquery speak.
>
> regards,
> Kristian
","29/01/12 11:14:50; rajesh; @mkristian how do you want to proceed? i have an idea of the layout, location, and text. do you need me to sketch a mockup or will a conversation do?",01/02/12 07:53:53; rajesh; @8a4d581 commit into the restricted branch should be enough for layout,"01/02/12 11:20:13; rajesh; nice to have (actually, i think this needs to be done ;) ) an option in the org profile, to:
allow only primary contact to change visibility options
or
any org member can change visibility options

please add this option to the org profile in the same form that they use to set visibility defaults, as a single checkbox or a radio button ",12/03/12 07:47:45; kristian; the eye catching fancy slider is now committed in the 'restricted' branch. I also upgraded to follow the rails_3011 branch a few days back.,"12/03/12 18:47:08; kristian; putting it into my words:
option that only the primary contact of the org can change any visibility option, i.e. the default visibility options of the org profile or the proj_report visibility

is that right ?","12/03/12 19:29:17; rajesh; am not sure what you mean about one half of your comment ...

what are the visibility options of org profile? currently, no changes to existing behavior needed.


re: proj_report - it is the only thing that has visibility options (structured reports - when they come will have to be designed for visibility).

we can allow only the primary contact to make a proj_report visible, partial, invisible.
they also can set default behaviour for future proj_reports.

should we allow an option (which the primary contact configures) that any org member can make changes to visibility?
this is a question, and i am happy to accept the simplest answer (which is likely to be only primary contact can make changes).","12/03/12 19:31:06; rajesh; adding @thornedev as we need to also consider privacy/visibility of structured reports.
they come in via sms and www, but will end up not in the same place as proj_reports but in some graph/data series.","13/03/12 06:27:40; kristian; well, let's see. when you can set a ""default visibility"" then you have two places where you have a ""slider for visibility"", one for the default and one for the project reports.

current ANY org member can change the visibility of a project report - maybe slipped through your first testing.

adding an option who can change visibility is the way to go. but still I do have two places: the default visibility and project report visibility

and here the question whether the above option holds for both places, i.e. primary contact vs. any org member ?
 ","13/03/12 06:32:01; kristian; then I realized that the notion of ""default"" is ambiguous. the two possible implementations:

* whenever a new project reports gets created the visibility is copied from the default 

* whenever a project report has NO visibility the value falls back to the default, i.e. any change of this default will change the visibility of the project reports which have no explicit visibility (null value in the database). once the project report has set visibility that value is taken.","13/03/12 07:11:48; rajesh; i think you have covered all the areas.

in the org profile there should be four defaults:

1. www report visibility default (slider)
2. sms report visibility default (slider)
3. structured report visibility default (slider) - yet to be designed, so a stub will do, but lets make an ad for the feature
in the future, it is likely we will add more stuff (twitter, email, ...)
4. ability to change visibility options (default is primary contact only, can set it to 'all org members')
(is it easy in the future to create sets of users with different powers?)

----------

in the proj_report (any type, sms or www), the option to change the default visibility status is available to:
- pwxadmin
- primary contact
- other org members (if the default permission in profile is changed)

---------

finally, when we migrate, all current proj_reports become fully visible (public) - lets not have any null values in the db.
if there are null values, then its should be fully visible.
","13/03/12 07:15:26; rajesh; please also add the nodal concept in the slider as per my comment 2 months ago (why does this issue tracker not give dates so that i can refer exactly to the comment?)

this will either be dummy (cannot be chosen) or will be exactly like funder - since we don't provide the concept of creating a nodal agencies and a group under it. ","13/03/12 07:20:18; kristian; my mistake I should not have talked about ""null values in the DB""
because that is really an implementation detail, -1 or -1234 or 666
would do the same.

migration is noted to move all to public.

but the question was whether to copy the default on creating a new
report or leave the report follow the organization default, i.e.
whenever the default changes the report visibility changes as well
unless you have set an explicit value on that report once ?","13/03/12 07:24:51; kristian; since I do not understand the nodal concept I would like to go for the
""display"" only way instead of something I do not fully understand

do I get the texts for the four different tabs + the nodal one ?","13/03/12 07:34:03; rajesh; sorry, did not clarify fully.

each report has its own visibility value.
if the default changes, it only affects new reports, existing reports retain their visibility status.

(this is my thinking, i am open to be convinced that a report can have 'default' as its choice and so its visibility changes as the default changes)","13/03/12 07:36:13; rajesh; can we put the tabs in this order: private, funder, nodal, pwx, public

nodal can be stub or act exactly like funder.

i will be happy to edit any placeholder text (easier than providing all the text now)","13/03/12 07:45:47; kristian; there are already nice latin texts in place on github - hope nothing
obscene in it since I can not understand it :)

the nodal can be done in that order but would like to just disable the
""update visibility"" button for the nodal. or actually I can but it
into the database in that order and figure out what to do with this
once we implement it.","13/03/12 07:49:54; kristian; FYI on each comment on github there is a link named ""commented"" which
you can copy in to your texts, emails, etc","13/03/12 08:15:04; rajesh; will let you decide what is easier for nodal - i don't see it being used this year (unless i can convince SRTT earlier).
so disable it without changing the database is probably best.","13/03/12 08:16:51; rajesh; i meant a comment in this issue that i can refer to. i would have liked to point to the 2nd comment (but its says 2 months ago, instead of a date or providing me a url) for nodal.

some nice german texts (Kafka?) would also be fine! :)",10/04/12 09:27:46; kristian; speced
number of apps peer reviewed,"@vamsee @vcolaco 
i am creating a new issue/ticket for this.
does not belong in #551

>Currently, the number of 'apps peer reviewed' we are showing is 213. This is being generated by a query that simply counts all the applications that have status_id set to greater than 1, which is anything that is not a draft. Which means we are counting apps in 'submitted' and 'withdrawn' stage too. I'm not sure this is accurate?

We can make it more accurate.
Lets not count 'submitted', but lets count 'withdrawn' (they may have had peer review)

> I think apart from checking the status_id, we also need to check if the 'needs_review' flag is set to false or not. Currently, we are counting apps which have needs_review set to false too. There are currently 27 apps (samburu, emw, wotr, etc) which have this set to false, so I guess this will reduce the overall (and earlier) number too. So, if I'm guessing right, the total number of apps peer reviewed would be the ones which are not a draft/submitted/widthdrawn, and also needs_review set to true. Am I correct? This would put the 'apps peer reviewed' number at 184.

Almost, just add withdrawn.
",16/12/2011 05:47:01,04/02/2012 17:01:45,Closed,rajesh,vamsee,Cisco | import,Cisco | import,Fixed,"16/12/11 07:36:40; vamsee; The updated count is on demo, but it still links to an action called 'list all apps', basically shows all apps except drafts. I thought of updating the list query to the same conditions as the count, but should we instead create a new page which lists all peer-reviewed apps and link the count there?","16/12/11 09:18:04; rajesh; How much effort will that be?
We will need a new page, a new item in drop down, etc.
nd it will affect many things (after logging in - 'all my applications').
Note on the map these applications do NOT show.

Choices in order:
      1. do nothing
      2. in the list show only peer reviewed apps (only way to go to these apps is from project)
      3. add option to show peer reviewed apps","16/12/11 10:18:14; vamsee; Hmm, creating an option to show peer reviewed apps is not a problem, but as you mentioned, there are dropdowns like 'All applictions', 'All active applications', etc. So if I am to add an option 'All Reviewed Applications', will it be accurate to include the applications that are currently under review also under this?","16/12/11 10:26:33; rajesh; They would come under Active, so it would be inaccurate.
But  it would be confusing ... 'My Active Apps' 'My peer reviewed apps' 'all my apps'","16/12/11 10:36:42; vamsee; Indeed. The other option is to not add any dropdowns, just show a different page that looks exactly like 'all applications' (with titles changed, etc) listing only reviewed apps. This page will not be accessible from anywhere else except for the link on the front page (for now).","17/12/11 08:55:50; rajesh; Only if this takes 10 min.
We need to put this work in perspective of other tasks, e.g. creating a slide show of a projects photos","18/12/11 11:30:32; vamsee; This is on demo now, please check it out. Simply created a new page with new apps query and changed the title. The rest is  the same as the full listing page.","18/12/11 15:17:09; rajesh; This is fine, though hard to get to 'all apps' without going to 'all active apps' first.

When it gets to qa / ability for me to modify text, let me know.","19/12/11 06:54:37; vamsee; I've put a ""--"" option in the drop down so both active and all apps can be accessed like usual (deployed to demo). Hope that suffices?","04/02/12 17:01:45; rajesh; ok for now, but final solution must include the ability to get to this screen from anywhere."
Upgrade to Rails 2.3.14,First step in the path to Rails 3 upgrade.,22/12/2011 14:50:42,07/02/2012 06:38:30,Closed,vamsee,vamsee,Rails 3,Rails 3,Fixed,07/02/12 06:38:30; rajesh; 2.3.14 is already deployed to www
plan for rails 3 and 3.1,"need a plan/documentation that is agreed on by all ( @ajaya @mkristian @vamsee )  for the rails 3 migration, that includes:

- steps (2.3.14 is already done, ... what else ...)
- effort estimation (already present)
- timeline (already somewhat present)
- known code issues: what is likely to break, what may need to be rewritten, ...
- plugin/gem: which are to be removed, which are updated, which should be improved (e.g. ferret)
- testing: vanilla, janova, regression, automated
- helpful ideas: eg. 
  -- adding some import changes to the mix to help test migration better
  -- upgrading server
  -- etc
- any other items
",26/12/2011 06:25:30,15/03/2012 05:53:39,Closed,rajesh,vamsee,Rails 3,Rails 3,Fixed,"26/12/11 07:46:43; vamsee; * Steps -> next is 3.0.11. I believe this is a more careful step than jumping to 3.1 directly. 

* Effort/Timeline -> The current timeline (mid-jan, most likely for 3.0.x) is still valid, but I'm not sure if we can do 3.1 by then. I'd either post-pone this or give one more week to this (this entirely conjecture, as I haven't worked with 3.1 before - I can research a bit more and update later).

* Known code issues -> this is also pretty hard to predict - but I'm sure the major issue we're going to have with 3.0.x is replacing Prototype.js code with jQuery equivalents, as 3.x makes jQuery the default library. I'll also update this as I research on this a bit later.

* I have already removed the 'vendored' Rails 2.3.5, and we're depending on gem versions of 2.3.14 now. I have also de-activated active_log as we're not really looking at logs much and it's adding a db hit by doing an extra log insert on every change. I will most likely remove this gem completely in 3.0.x. I have already removed cucumber as we're not using it and gherkin (a dependency) has become a pain when it comes to installing native extensions w.r.t gcc compatibility. asset_packager will likely go in 3.1.x, as Rails has it's own blessed version of it now. Ferret is also most likely to go in 3.0.x, I'm gravitating towards Apache Solr for full text search. Comments welcome. I will update what else I'm going to remove in the future. 

* Testing: I will take forward Janova based on @vcolaco's time/interest. For plain vanilla testing we're going to stick with mini_test. We might consider a CI server, but only once there is a substantial test suite.

* Will add more items as I think of them. 
","26/12/11 07:59:53; vamsee; * file_column is also up for a change, I think (I can't find a Rails 3 compatible gem). my current preference is attachment_fu, but if anyone has better choices, let me know. 

* Oh, most importantly - I'm thinking of rebuilding the server on an Ubuntu 10.4 LTS ec2 image - and maybe even use Chef for setting this up (I've been playing around with Vagrant+Chef recently). But will probably skip Chef if it turns out to be as frustrating as it is with Vagrant. ","29/12/11 09:28:48; kristian; * rails 3.1.x vs rails 3.0.x : I never worked with rails 3.1.x mainly it introduces quite some ""new"" things like asset pipeline which work differently for development and production. it looks like these things are still maturing. moving to rails3.1 feels a bit hasty (IMO)

* solr is quite a big application (worked with lucene and solr quite regularly) and a s java application it is memory greedy (cost factor - maybe). on the other hand i think it is a good choice.","30/12/11 09:24:55; vamsee; Yes, I'm not gunning for 3.1 right away, unless it turns out to be a surprisingly easy upgrade from 3.0.x. As for solr, yes, I do realize it needs jdk etc to run, so I'm not too sure either. If integrating that doesn't make sense, I'll go for thinking_sphinx.","31/12/11 13:42:49; kristian; yes- the rails 3.1 migration might be straight forward ;-)

about the search and reading your reply I do have the feeling that putting the search behind a facade would help to switch from ferret to solr to sphinx (or is it thinking_sphinx) to solr to lucene to . . . . i.e. get the code use the facade-API and then you can switch implementations easily. solr as such is great - not sure if ferret is really much better in production under load. java usually plays really nice when it comes to load and concurrency but the initial memory consumption is the only problem (or not).","07/01/12 18:00:21; ajaya; I think we should separate 3.1(3.x) migration into two separate buckets. This includes the work Vamsee doing on 3.0 now.

1. Migrate as is with 3.1 compatibility upgrades for components.  Only try to upgrade gems/version/plugins if it's required for 3.1 upgrade.
2. Look at feature upgrades like search, attachment etc ONLY if current code not compatible with 3.1 and it's a pain to try to make the existing code work with 3.1
3. 3.1 migration must result a noticeable feature addition to PWX.  I had suggested i18n as one feature that we can use.   I would suggest to look at one piece of code ( comments in review etc ) and try to make it i18n enabled.

I understand that there is a eagerness to improve and clean up legacy code.   When planning/acting on 3.x releases, focus on getting the existing code to work and ONLY look at any wholesale migration of dependant modules/plugins etc as a separate task itself that needs to sell itself.   We need to migrate the code base on a piecemeal basis.
","08/01/12 04:09:35; vamsee; @ajaya thanks for the pointers. My plan is pretty much on the same lines. Initially I was keen to build up a new instance, with fresh rubies, but given how many things are breaking even with 3.0.x upgrade, I scaled down my plans. Right now, here's what I'm trying to do:

1. Get the upgrade to 3.0.11 working first on Ruby 1.8.7. I think we made good progress on this so far (at least the app starts, updated routes hold up and doesn't crash in flames like earlier), but I haven't tested anything deep yet. This coming week I will get more into this.

2. I will be writing a few tests as I fix issues with the 3.0.x upgrade, which I think should also help us with 3.1.x. This might take all of coming week.

3. I think i18n is pretty easy even in 3.0.x. I'll enable this and setup a few example translations, and @vcolaco can do the rest of the translations when she's free.

4. I'm not so eager right now to clean up legacy code, but more like getting it up to shape to run in 3.0.x at least. I had to remove most of the plugins and move to more recent gems (via bundler). I have a feeling file_column is going to be a pita, as I haven't see any Rails 3 compatible forks of the plugin yet. Will update more on this and the options open to us in a couple of days. 

5. Yes, I would agree with you and @mkristian that 3.1 upgrade might be a separate effort in itself - we are using quite a bit of Prototype.js code, and from 3.1 onwards Prototype has become optional and jquery/coffeescript the default. Also it has it's own asset packager (sprockets) so asset_packager plugin has to go, and I would have to update the deploy scripts to handle this properly. So I'm guessing that is going to be at least a week or two's worth of effort itself. @satyagrahi perhaps we should look at this next month, once we're fairly sure the 3.0.x upgrade has stabilized? We can also look at the upgrade to Ruby 1.9.2 and building a new ec2 image based off Ubuntu 10.04 LTS then. (I can get to some of those features you want for Arghyam in between).

That's the plan so far, please let me know if you have questions/suggestions.
","08/01/12 05:55:19; ajaya; Agree with 1-4.

On 5:
1. Keep prototype and most of the JS related stuff as is for now.   Both jQuery and Prototype are interchangable in 3.x.  Wierd is we use both.  So I would rather not touch that or burn in hell.
2. Asset packager should also stay as is unless the migration is easy.   This is I think the messiest part of Rails 3.
3. Our current VM in Amazon cloud is still a very well supported ubuntu release.  You are not going to get anything building a new VM.  We can still upgrade to 1.9.2 on the current one.  I am thinking moving to rvm and letting rvm/passenger/apache/ngnix if we need 1.9.2.  At 1.8 level, enterprise ruby has served us well.

","08/01/12 19:32:15; kristian; reading all this I have to mention that rails 3.2 is about to released and rails 4 basically started to exists. my feeling of rails3.1 is that it is still maturing and so it could wait for some time but in the end rails 3.1. looking at rails 3.0.x, rails 3.1.x and now rails 3.2.x I really wonder if they will support all three with security updates - probably yes BUT I am sure rails 3.2.x will be the one which gets most attention.

rvm in itself is controversial  - see https://github.com/sstephenson/rbenv - so I am using rbenv or just out of the box ruby ;)
rvm on a server is even more controversial. debian is considered to be very secure and stable, from that point of view I would go for debian with passenger/apache/ruby packages coming from an official debain repo. since we use ubuntu I would go for LTS only and use  passenger/apache/ruby coming from an official ubuntu repo.

there are already gems around which do not run on ruby18 anymore. so for me a move to ruby192 means to switch to a ubuntu version which offers that ruby version.","09/01/12 04:28:27; ajaya; We should look at switch to 1.9.2 to only in case when we have gems that we depend on that needs it OR we doing something that needs it.

With that said, I have no opinion on on what ruby distribution we use.  We have traditionally use Enterprise Ruby with Passenger.  I am just trying to avoid to spin another server until the point we really need it.  Until then keep hacking on what we have.  When we do make a switch to 1.9.2, we will just do a wholesale migration of the server and sunset current one.

Server migration should be dealt on it's own ticket.  We got a whole lot of thing to migrate.","24/01/12 11:24:21; vamsee; Hi all, I've deployed the rails_3011 branch to demo.peerwater.org, please take a look when you have time. I'm fixing some bugs as we speak, but if you run into any, please check the 'Rails 3' milestone if it's already filed and then file if it hasn't been. Thanks.

As for changes I had to do, I rewrote the routes.rb completely, and cleaned up some of the weird mappings - that meant I had to change a lot of paths in the views, but I believe I have ironed them out mostly. Luckily, file_column still seems to work, so that saved a bunch of work. Updated almost all the plugins, and moved a bunch of them into Gemfile. Had to install a prototype 'adapter' plugin to make calendar_date_select work, we'll have to look at moving fully to jQuery sometime soon. 

Had to remove searchlogic completely and replace the calls with AR scopes, as the current plugins on rubygems.org fail in weird ways with Rails 3. Fix minitest helper to work with Rails 3, etc. If you want the full gory details of the upgrade, please look at the commit list linked from #587. I still haven't written enough tests, but now I'm starting to with @vcolaco and @satyagrahi finding some bugs for me. I'd very much appreciate it if you all take a look.","24/01/12 11:28:33; vamsee; Forgot to add, I added a few stubs for i18n to start the translation. Luckily, this was fairly straightforward with Rails 3, so didn't run into any issues so far. If you want to test this, try demo.peerwater.org/es - that should change the title to Spanish, and it's being loaded from config/locales/es.yml. This is just a start, but we have the framework in place to start translations. ","24/01/12 13:48:09; rajesh; 
    lets create separate
      issues to track fixes instead of one humoungous issue.
      @vcolaco, please edit your comment - copy all the text and put it
      on a new issue.","07/02/12 07:04:36; rajesh; now, the plan needs the deployment process timing.
when are we going to deploy it to qa (staging)?
and focus on testing/ fixing so it gets to www - no other bugs/fixes to the Rails2 branch

assume solr is the only item remaining.","07/02/12 07:11:11; vamsee; I will push the Rails 3 branch to QA as soon as Solr is integrated. My guess is by the end of this week. Another couple of days if some errors happen. I think the rest of the app is stable enough to be pushed to QA right now, but I'd wait until Solr is also ready. I'm negotiating with @vcolaco about treating her for each additional bug she finds on demo :)","07/02/12 07:35:33; rajesh; hey, don't i deserve some treats? i seem to be causing the most crashes and finding the most bugs.
is it because @vcolaco eats meat and makes fish dishes? and will look awesome at 51?","07/02/12 07:56:25; vinita; :-) LOL, u did see that article. 

Vamsee - will sent you the test results soon.
","07/02/12 10:22:43; vamsee; @satyagrahi well, because you didn't hear the other part of the plan - to make you pay for the treats :D. But since my mom sent me some sweets, I think I can give one besan ka laddoo for each bug :).","07/02/12 10:31:10; rajesh; i was assuming it was all meat related, and only about jolly, happy, (and potentially overweight) folks!

did not realize the team had sneaky ideas.

but regarding treats: a big celebration is called for on launching 3.0, minor ones for solr/qa, janova testing deployed, etc.",07/02/12 10:35:51; vamsee; @vcolaco looks like we're not gonna hear the end of this jolly/happy/overweight taunting for a while :),"07/02/12 10:43:25; rajesh; 
    
    us skinny veggie health nuts get crankier and crabbier as we grow
    into crusty curmudgeons that nobody wants to be around. @madanvk has
    a choice to make soon. he can be my partner in an old folks home as
    we snarl and jab our walking sticks at all passerbys while our
    wheelchairs get pushed around by rude aides. or be at home with many
    grandchildren crawling all over him begging for another eclair or
    donut.","15/03/12 05:53:39; rajesh; closed by the not-so skinny veggie guy, still crabby though."
Upgrade to Rails 3.0.11,Step 2 towards Rails 3.x move,29/12/2011 06:30:33,10/04/2012 03:44:24,Closed,vamsee,vamsee,Rails 3,Rails 3,Fixed,"05/01/12 08:10:10; vamsee; Adding @satyagrahi 

Wow, our routes file is really, really long (> 1k lines). And not to mention unnecessarily complicated in many places. I have a feeling the project's been worked on by some devs who didn't really understand REST. A big routes file means all those instructions have be parsed every time there is a new request, and it adds to the app startup time. Will try to simplify this as we go forward. Not going to be easy, as routing is married to the folder/controller structure, and I'd have to refactor/move these when required. Not going to do that now, the emphasis is more on writing some tests before I change something like this. For now concentrating on moving the entire routes file to the new routing API and making sure everything works like before.","05/01/12 09:39:11; rajesh; i thought i had created a ticket to fix the home_page routing, but can't find it anywhere.

so here are routing requests:

1. remove home_page from the url for all home_page pages

2. analytix routing has to be fixed, analytix/project and analytix/impact and ...

3. proj_report, etc. should be project_

4. app -> application


good this will be cleaned up, am sure @ajaya has several stories on the original team development and on his solo efforts a couple of years ago to make all project/app pages RESTful","05/01/12 13:33:09; rajesh; what is the range of sizes of route files for a project like ours?
what would a good size for us be?","06/01/12 01:22:07; vamsee; I'm not sure I have a grasp of all parts of the system to answer this correctly, but from what I can see from the conversion to new API we could do away with about half the routes fairly easily (but might be too much of a trouble to do it right now). I'd be surprised if most projects of our size extend beyond ~500 loc in routes. Our problem is mainly that the original coders didn't use what Rails offers by default - and ended up writing explicit routes instead of using implicit REST ones (and overall code clarity suffered a bit because of this). We can fix a good part of these issues with a few rounds of cleanups, but I'd worry about this after Rails 3 upgrade and a couple of other urgent features (sms improvements/permissions, etc) are in. I'd anyway be doing small cleanups as I code/test the parts that changed for Rails 3.","07/01/12 05:58:39; vamsee; Was there an attempt at getting a mobile interface working? I see a plugin called mobile_fu and some related code, but it's getting activated only when it's *not* in production mode."
Funding Agreements - make the process prominent and recallable,"Today, the funding agreement is visible only at the time of accepting the funding. The agreement cannot be seen later and also it can be changed (by admin). Also, its not clear who accepts the agreement (could be a clerk, an intern, or the ED).

We need to:
1. freeze the agreement at the time of acceptance (of the app)
2. make it accessible for later to the implementer and the funder (good from app or from project)
2b. make it more prominent and visible - a reminder of what folks were supposed to do
3. enhance it for multiple agreements from different funders for the same app

Currently, BPN has moved to written agreements (2 samples attached), a formatted signed version on official letterhead of the text that is present in the BPN2011 cycle on PWX:
https://www.dropbox.com/home#/git%20attachments:::77042152
https://dl-web.dropbox.com/get/pwx/git%20attachments/BPN-PADI-GrantAgreement.tif?w=d5ce3649
https://dl-web.dropbox.com/get/pwx/git%20attachments/PWX-Eko%20Agreement.jpg?w=92d6ed75

@ajaya (and @vamsee) and i have discussed this: text copied below, conversation will be documented by @ajaya

On 29/12/11 9:30 AM, Ajaya Agrawalla wrote:
> For us agreements are traditionally attached to a cycle.  It doesn't make sense to have application specific funding agreement unless we would really need that. 
Well, i meant - for each application in that cycle, choose which agreement (from that cycle) gets displayed when the application gets approved.

What you have said below is good - likely to work for 90% of cases. In case a project is funded by 2 funders (e.g. http://peerwater.org/apps/379-Rainwater-harvesting-systems-at-2-schools-and-support-for-ACI-school-based-Water-Hygiene-Clubs ) then how would it work?

Right now we have an agreement for BPN which we have to replace with Arghyam's when they choose a couple of projects. Maybe we should even store the agreement in effect with the app so as to remind the person of what they agreed to. Now, unless they print out that page, there is no way to look at it afterwords too.

Thanks,
Rajesh
>
> With that said, we should be able to make the funding agreement <= ( belongs to ) to a funder ( funding whole / part of a cycle ).. also we could keep the  agreement <= (belongs to) cycle intact also and that extra relationship.
>
> Makes sense?
>
> Ajay
>
> On Wed, Dec 28, 2011 at 3:50 AM, Rajesh Shah <rajesh@peerwater.org> wrote:
>
>     Hi Ajaya,
>
>     Need your insight (and possible coding!) regarding funding agreements.
>     For
>     We can create multiple agreements and when someone accepts funding they have to accept all of them (and its not clear that there are multiple separate agreements).
>
>     Is there a way to assign agreements to apps?
>
>     If we have 2 funders and they have different agreements and they fund different proposals.
>     The apps funded by the funders will need separate agreements.
>
>     We have the data, but need something in the process.
>     Thoughts?
>
>     Thanks,
>     Rajesh
",30/12/2011 05:37:38,30/12/2011 05:37:39,Open,rajesh,ajaya,Wish List,Wish List,Unresolved
mobile website,"over one year ago we (Seema, Vallari, Larrie, ...) had met and developed a mobile strategy. using this space to document some of the email exchanges.

need to decide whether to include in our 3.0 transition - i thought it had been deployed.

-------------------------

Greetings,

Apologies for this very late meeting notes for the meeting held on Dec 2nd. Please add anything I may have missed.

For folks who were not part of the meeting - some background. - Seema is an technical architect in the mobile space and has offered her services to PWX. Hence Abhishek, Seema and I met to define requirements/scope and nailed some high level requirements and timeline.

Thanks,

vallari

--------------------------------------------------------------------------------
It was agreed that the focus in not to have PWX on the mobile but, initially use the mobile for the ""Wow"" factor and hence more for the marketing. Typical use case is any one on the Peer Exchange/BPR  team member is at a conference, dinner and want to share PWX with them - hence pull up the summary page and map
I The scope of the summary page and map
  - Currently show static data for summary with some news link. Content to be shown on the mobile channel would be defined and a separate page created at least in the short term
  - Map - would be browser based, with a drop down selection of country from  the continent. And show 3-4 of the legend icons (from what is available on the PWX site) and on clicking on it show static marker data.
Issue - Should the mobile channel use interactive map or static maps
Action Item - Research for optimal solution - Seema
Some elements of the existing style guide would be leveraged by Seema.
Action Item - Provide the existing style guide to Seema - Rajesh / Abhishek
Action Item - Pick the 3-4 legend icons of the map that should be shown on the mobile and the amount of data on the map. Conclude on the static data that should be shown on the Summary page - Rajesh
- Where would the business/service layer reside for this channel?
- In the existing code base, but a separate interface would be created for the mobile channel and services made available for the mobile channel as needed for the above scope
Action Item - Provide details on the current dev/test environment setup and dev env setup for Seema - Abhishek

Project timeline
- By EOM complete detail requirements (Rajesh) and understand the architecture (Seema) and provide necessary docs on style guide/architecture/env (Abhishek/Rajesh)
- Develop summary page by Jan 15th
- Understand interactive v/s static maps on mobile technology and conclude on direction Jan 15th
- Develop map functionality by Feb 15th
- Testing to be completed by end of Feb and Released.

Please consider the timeline shifted by 2 weeks as the initial steps expected to be completed this month have not been worked on - hence Release timeline mid February.

-----------------------------------------------------------
On Fri, Nov 26, 2010 at 12:44 PM, Vallari Shah

Hi Seema,

Can we connect Tuesday morning? - say for 2 hrs? (Rajesh and I are out of Town beginning Wed night and we come back on 9th night).

What I would like to accomplish is to be on the same page with you on the following:

What would be the scope of the summary page and map
  - data to be shown,  level of drill down, etc
  - look and feel - same style guide can be applied as that on the website? something simpler?
  - would it have geographic constraints in terms where it would be viewable from? just US? worldwide?

Some tech considerations
  - Would this be mobile technology agnostic, i.e. can work on blackberry, iPhone, android ...
  - Should it be an download-able mobile app or browser    based?
  - Where would the business/service layer reside for this channel?
  - What is likely maintenance /service issues that are likely to be created?
  - How easy is it to extend this to adding additional functionality?
  - What would be needed in terms of environment for development and testing and then the scope of testing
 
Based on the above define a rough timeline.
Define what would you need in terms of tech help/support from Abhishek and anyone else

Let me know if the above makes sense (and of course add stuff that I have missed) and if the day/time can work and whether we can meet at my place in LW.

Looking forward to working with you :)

Thanks,

vallari



    On Fri, Nov 26, 2010 at 12:44 PM, Rajesh Shah <rajesh@peerwater.org> wrote:

        Dear Seema,

        Welcome to the PWX team!

        Thanks for your thoughts. We (Vallari, Larrie, Abhishek & i) discussed them this morning and want to go ahead. Our primary considerations:

        - prove our tech ability in the mobile space
        - create buzz and some marketing ability
        - give you most flexibility without burdening the team
        - do something with least burden of requirements
        - do something with minimum interfaces, data i/o, manual interfaces
        - create an initial first step and then figure out directions and requirements

        Based on that we want to go with your #1 & 2 to the stakeholders.
        Create a mobile app that has a way of showing statistics, summary, a map, and locating a project.

        Then we can take it further.

        We will let you decide about platforms, etc. Vallari (who is free Tue & Wed) will work with you to help define, refine, etc. and Abhishek will provide tech support.

        Regards,
        RajeshGreetings,

Apologies for this very late meeting notes for the meeting held on Dec 2nd. Please add anything I may have missed.

For folks who were not part of the meeting - some background. - Seema is an technical architect in the mobile space and has offered her services to PWX. Hence Abhishek, Seema and I met to define requirements/scope and nailed some high level requirements and timeline.

Thanks,

vallari

--------------------------------------------------------------------------------
It was agreed that the focus in not to have PWX on the mobile but, initially use the mobile for the ""Wow"" factor and hence more for the marketing. Typical use case is any one on the Peer Exchange/BPR  team member is at a conference, dinner and want to share PWX with them - hence pull up the summary page and map
I The scope of the summary page and map
  - Currently show static data for summary with some news link. Content to be shown on the mobile channel would be defined and a separate page created at least in the short term
  - Map - would be browser based, with a drop down selection of country from  the continent. And show 3-4 of the legend icons (from what is available on the PWX site) and on clicking on it show static marker data.
Issue - Should the mobile channel use interactive map or static maps
Action Item - Research for optimal solution - Seema
Some elements of the existing style guide would be leveraged by Seema.
Action Item - Provide the existing style guide to Seema - Rajesh / Abhishek
Action Item - Pick the 3-4 legend icons of the map that should be shown on the mobile and the amount of data on the map. Conclude on the static data that should be shown on the Summary page - Rajesh
- Where would the business/service layer reside for this channel?
- In the existing code base, but a separate interface would be created for the mobile channel and services made available for the mobile channel as needed for the above scope
Action Item - Provide details on the current dev/test environment setup and dev env setup for Seema - Abhishek

Project timeline
- By EOM complete detail requirements (Rajesh) and understand the architecture (Seema) and provide necessary docs on style guide/architecture/env (Abhishek/Rajesh)
- Develop summary page by Jan 15th
- Understand interactive v/s static maps on mobile technology and conclude on direction Jan 15th
- Develop map functionality by Feb 15th
- Testing to be completed by end of Feb and Released.

Please consider the timeline shifted by 2 weeks as the initial steps expected to be completed this month have not been worked on - hence Release timeline mid February.

-----------------------------------------------------------
On Fri, Nov 26, 2010 at 12:44 PM, Vallari Shah

Hi Seema,

Can we connect Tuesday morning? - say for 2 hrs? (Rajesh and I are out of Town beginning Wed night and we come back on 9th night).

What I would like to accomplish is to be on the same page with you on the following:

What would be the scope of the summary page and map
  - data to be shown,  level of drill down, etc
  - look and feel - same style guide can be applied as that on the website? something simpler?
  - would it have geographic constraints in terms where it would be viewable from? just US? worldwide?

Some tech considerations
  - Would this be mobile technology agnostic, i.e. can work on blackberry, iPhone, android ...
  - Should it be an download-able mobile app or browser    based?
  - Where would the business/service layer reside for this channel?
  - What is likely maintenance /service issues that are likely to be created?
  - How easy is it to extend this to adding additional functionality?
  - What would be needed in terms of environment for development and testing and then the scope of testing
 
Based on the above define a rough timeline.
Define what would you need in terms of tech help/support from Abhishek and anyone else

Let me know if the above makes sense (and of course add stuff that I have missed) and if the day/time can work and whether we can meet at my place in LW.

Looking forward to working with you :)

Thanks,

vallari



    On Fri, Nov 26, 2010 at 12:44 PM, Rajesh Shah <rajesh@peerwater.org> wrote:

        Dear Seema,

        Welcome to the PWX team!

        Thanks for your thoughts. We (Vallari, Larrie, Abhishek & i) discussed them this morning and want to go ahead. Our primary considerations:

        - prove our tech ability in the mobile space
        - create buzz and some marketing ability
        - give you most flexibility without burdening the team
        - do something with least burden of requirements
        - do something with minimum interfaces, data i/o, manual interfaces
        - create an initial first step and then figure out directions and requirements

        Based on that we want to go with your #1 & 2 to the stakeholders.
        Create a mobile app that has a way of showing statistics, summary, a map, and locating a project.

        Then we can take it further.

        We will let you decide about platforms, etc. Vallari (who is free Tue & Wed) will work with you to help define, refine, etc. and Abhishek will provide tech support.

        Regards,
        Rajesh",07/01/2012 06:27:41,22/03/2012 17:21:15,Open,rajesh,vamsee,Wish List,Wish List,Unresolved,08/03/12 11:44:05; vamsee; Does this belong in Rails 3 milestone?,"08/03/12 17:31:33; rajesh; this one always seems to get dropped. since you have a android phone, it might be worth checking to see what works now. if its working (or just needs to be deployed to work) then we can address and close it. 

if it requires a lot more work, move it to the next release, i guess. we don't have a process to incorporate misc features to releases.","09/03/12 06:20:36; vamsee; And you will have one soon :). But the mobile thing is a whole diff ballgame, worthy of it's own milestone. I don't think this can be shoehorned into R3, and I think at this performance the site will be too slow on EDGE to be of much use any way. I would move it to a time when we're fairly confident the site is quite performant (from the db pov)."
existing privacy functionality - Rating & Comment,"currently we have privacy working for final Rating & Comments of apps and orgs 

if you are not logged in, you cannot see who made the final rating.

this should work using our new framework, shouldn't it?

adding @vamsee and @ajaya (who wrote the existing code)
",13/01/2012 12:13:44,10/04/2012 09:34:30,Open,rajesh,rajesh,Controlled Visibility / Privacy,Controlled Visibility / Privacy,Unresolved,10/04/12 09:34:26; kristian; should do already
existing privacy functionality - Individual info,"currently we have privacy working for individuals

if you are not logged in, you cannot dig into individual's contact data from the forms.

this should work using our new framework, shouldn't it?

adding @vamsee and @ajaya (who wrote the existing code)
",13/01/2012 12:15:14,10/04/2012 17:02:24,Closed,rajesh,rajesh,Controlled Visibility / Privacy,Controlled Visibility / Privacy,Fixed,08/04/12 01:57:22; vamsee; @satyagrahi what do you mean by 'new framework' here?,"08/04/12 05:23:11; kristian; the ""new authorization"" framework",10/04/12 09:33:30; kristian; should do already
existing privacy functionality - Individual info in search,"currently we have privacy working for individual info

if you are not logged in, search gives you results but greys out (makes non-clickable) the results for contacts.

this should work using our new framework, shouldn't it?

separated it from #591 because its a different area, but could be combined.

adding @vamsee and @ajaya (who wrote the existing code)
",13/01/2012 12:17:25,10/04/2012 14:14:38,Open,rajesh,kristian,Controlled Visibility / Privacy,Controlled Visibility / Privacy,Unresolved,"06/04/12 03:21:55; rajesh; also as mentioned to @mkristian we need to not show search results that violate privacy.

for e.g. 
- public searches should not show items that have been marked peer (or more restricted)
- peer searches should not show items marked funder (or more restricted)
- funder searches should not show items marked org

","06/04/12 10:41:51; kristian; just to wrote up a little note on how the search index could be
modeled and by this solving the visibility filter on the search index
itself.

https://docs.google.com/a/peerwater.org/document/d/1UFMWNgn6KDFKJREwI6qF7sUztf3NWSEobvyTV0cwckY/edit","07/04/12 06:24:15; rajesh; @mkristian , thanks for sharing your thoughts.

adding @vamsee , @ajaya, @madanvk , @thornedev .
please read this short google doc where K looks at rethinking search based on the new search engine. we have an opportunity to rethink something that is good, and make it better - both in performance and usefulness.

there are 2 things that come to mind, both regarding privacy:

1. how do we protect 'private' data from search engines? how do we put a cordon around private data? do we have to cordon all proj_reports (at least the ones created by org itself)?

2. regarding PWX searches: building privacy into our search index would be certainly more efficient. we have to think now when/if we have 1000's of private reports and then filtering post-search v pre-search indexing would be certainly be advantageous for the latter.

","08/04/12 01:49:55; vamsee; I will be reading more thoroughly and think a bit about this, but two things right away:

 * I'm very *down* on anything custom-coded that circumvents or overrides what's already available in Rails or 3rd party plugins. I hope I don't have to restate the advantages of 'sticking to defaults'. We've been down that path already.

 * I don't think protecting search results is a specialized enough requirement to warrant circumventing anything. Putting privacy in the search engine might be nice, but it means pushing domain/business logic into the search engine. This is like stored procedures in a db - don't go there unless the results are astonishingly good. These special stuff tends to get unmaitainable after a while (for example, what if we switch from Solr to something else?).

Couple more things:

 * Sunspot does provide a way to pull results only from the Solr index, and not hit the db, if I remember its API correctly.

 * Yes, Sunspot does handle similar-named fields in separate models correctly.

That leaves only the Ajaxy stuff that mandates this. I'm even willing to take a performance hit if it means our upgrade paths are as simple/clean as possible. So there has to be more justification than that to go this way.","08/04/12 05:18:00; kristian; my suggestion from the paper works perfectly using only sunspot - just
leave out the ajaxy stuff which is labeled ""possible"". so all the
business logic stays in the search-model or in the controller (the
pwx way of coding business logic).

just using sunspot to use solr the solr way :) i.e. ONE search query to retrieve the complete result set you need for generating the result page.",08/04/12 05:42:51; kristian; one more thing about privacy. if privacy is taken seriously then the public admin interface where you can query the search index directly needs to be at least behind a password protection.,"10/04/12 13:33:45; vamsee; Well, I'm trying to move as much business logic as possible from the controller into the models, so please consider the earlier way of doing things as 'deprecated'. I'm not sure I understand the second sentence. ","10/04/12 14:14:38; kristian; the search model will not be an active-record but an active-model or a
plain-old-ruby-object with sunspot DSL added to it and using
solr-facet with the help of sunspots DSL"
Download all attachments,"http://peerwater.org/organizations/142

When reviewing an organization, would be nice if there was a single click to ""download all attachments"". ",16/01/2012 05:41:06,17/01/2012 05:31:59,Open,madan,vamsee,Wish List,Wish List,Unresolved,17/01/12 05:20:33; rajesh; is it easy to add functionality by linking to google docs to view attachments online?,"17/01/12 05:24:49; madan; Either view all in separate tabs OR download all.
If I'm online, then I would like view all in separate tabs.  If I'm heading
out, I like to download all and then read at my leisure.

On Tue, Jan 17, 2012 at 10:50 AM, rajesh <
reply@reply.github.com
> wrote:

> is it easy to add functionality by linking to google docs to view
> attachments online?
>
> ---
> Reply to this email directly or view it on GitHub:
> https://github.com/pwx/code/issues/593#issuecomment-3523346
>



-- 
Thanks,
Madan Kumar","17/01/12 05:29:35; rajesh; right now all attachments are together.

we also need to separate photos from docs.
this way we can put in a nice slide show (as Vamsee has promised to deliver using one of the many slick FOSS in 10 min :) )
"
document current server/backup/deploy setup,"we (me and @vamsee ) need to document:

1. current backup setup and process

2. restore procedures (including risks of data loss, etc.)

3. asset packaging with deploy (intent and hi-level description of rake tasks)
 - if moving to rails3.1 mandates the removal of asset_packager, what is the procedure?

4. things to look out for when moving off the server

",23/01/2012 06:25:51,10/04/2012 03:46:06,Open,rajesh,vamsee,Ruby 1.9.3 Rails 3.2,Ruby 1.9.3 Rails 3.2,Unresolved
install rvm (or rbenv),"see #586

we need to move to Ruby 1.9.2 (Rails 3.2 removes support for 1.8.7) and need rvm or equivalent.

one option is to create a new server config (T1.micro?) for all Rails3 and Ruby1.9.2 testing
and obviously the other option is to put it on the current server
and doing both is the third option.

@vamsee @mkristian ",23/01/2012 06:30:39,15/03/2012 05:52:13,Closed,rajesh,ajaya,Rails 3,Rails 3,Fixed,"26/01/12 05:56:19; kristian; going for ruby version from the OS gives the advantage of getting
security updates through automated ""security update process"" (if it is
setup). the current ubuntu version comes with ruby-1.8.7 and that is
enough for rails-3.2 and the coming LTS (this april) will come with
1.9.3 (if I remember right). so there is no need for this rvm, rbenv
etc and try to keep the security patched manually.

On Mon, Jan 23, 2012 at 12:00 PM, rajesh
<reply@reply.github.com>
wrote:
> see #586
>
> we need to move to Ruby 1.9.2 (Rails 3.2 removes support for 1.8.7) and need rvm or equivalent.
>
> one option is to create a new server config (T1.micro?) for all Rails3 and Ruby1.9.2 testing
> and obviously the other option is to put it on the current server
> and doing both is the third option.
>
> @vamsee @mkristian
>
> ---
> Reply to this email directly or view it on GitHub:
> https://github.com/pwx/code/issues/595","15/03/12 05:52:13; rajesh; am going to close this, if you techies feel the need please open it."
safari browser keeps login info for analytix,"on safari on mac, analytix keeps coming up with empty map AFTER a user logs out.
both Team Blue (zero projects) and BPN (5 projects) had the same behavior.

on two computers, the analytix window showed the login info (one was Safari on OSX and other IE8 on XP).
other pages showed the login boxes, only analytix was using expired cache/session data

adding @ajaya @madanvk @vinita
",23/01/2012 09:46:24,23/01/2012 09:47:18,Open,rajesh,vamsee,Bug Fix,Bug Fix,Unresolved
rural v urban classification,"need to classify projects as to whether they are:
- urban
- rural
- peri-urban

best idea is to have checkboxes (allowing multiple choice) near the map.

the real challenge is to put this in search, to allow sorting in project lists & analytix.

adding @ajaya @madanvk @mkristian @vcolaco ",23/01/2012 09:52:37,23/01/2012 09:52:38,Open,rajesh,vamsee,Wish List,Wish List,Unresolved
column filtering power (analytix 2.0),"@madanvk wants column filtering in project lists / analytix

choose what columns and what ranges/values/options per column

in the final version map should be optional, so loading time improves.


maybe first start by:

- changing project list page, expanding size to full width

then

- change/merge analytix page 

to end with only one page.

of course, some session info/cookie needs to be stored to remember preferences.

@ajaya @mkristian - get involved, lots of design and blue sky options",23/01/2012 10:00:57,23/01/2012 10:00:57,Open,rajesh,vamsee,Wish List,Wish List,Unresolved
org list enhancement,"the org list needs a facelift:

http://peerwater.org/organization_search/organization_search?link=country&orderby=asc

we need secondary sort, if we sort by country, then the orgs should be sorted alpha, not by org_id (default should always be ascii for org)

explicit secondary sort, like in analytix would be great.

adding columns by using the entire width of page would be great. will provide columns to be added on request.

and adding column chooser - wow!

adding @ajaya @mkristian @madanvk @vcolaco 
keep the app list also in mind ... ",23/01/2012 12:03:08,23/01/2012 12:03:08,Open,rajesh,vamsee,Wish List,Wish List,Unresolved
search with wildcard bug,"search for *d* and Germany shows up in the country list.

ferret bug or our code?",23/01/2012 12:13:44,23/01/2012 12:13:44,Open,rajesh,vamsee,Bug Fix,Bug Fix,Unresolved
